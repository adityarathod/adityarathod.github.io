<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Aditya Rathod | Predicting Titanic Survivors: My First Machine Learning Model</title><meta name="robots" content="index,follow"/><meta name="description" content="Learn how to build a machine learning model to predict Titanic survivors based on the Kaggle dataset."/><meta property="og:title" content="Aditya Rathod | Predicting Titanic Survivors: My First Machine Learning Model"/><meta property="og:description" content="Learn how to build a machine learning model to predict Titanic survivors based on the Kaggle dataset."/><meta property="og:type" content="article"/><meta property="article:published_time" content="2018-08-04T23:00:00.000Z"/><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/dd67a8de90d82862.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dd67a8de90d82862.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-b6ae7f85f00af153.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1b961b81afafe8a2.js" defer=""></script><script src="/_next/static/chunks/675-8610370ef62a12c1.js" defer=""></script><script src="/_next/static/chunks/845-4fd11481df1204c1.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-c0bf3d55c00ed0d2.js" defer=""></script><script src="/_next/static/jnr1Acdo_7E6QFZUGdTBG/_buildManifest.js" defer=""></script><script src="/_next/static/jnr1Acdo_7E6QFZUGdTBG/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section><div class="w-full bg-cyan h-[3px]"></div><header class="mt-3 px-8 py-3 mx-auto flex flex-row items-center justify-between sm:justify-between md:justify-start lg:justify-start xl:justify-start"><div class="mr-0 sm:mr-0 md:mr-8 lg:mr-10 xl:mr-10 text-center"><a class="font-bold text-2xl text-white opacity-100 hover:opacity-80" href="/">Aditya Rathod<span class="text-spring">.</span></a></div><div class="flex-1"></div><nav class="hidden sm:hidden md:flex lg:flex xl:flex flaex-1 flex-row items-center"><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity ml-10" href="/#projects">Projects</a><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity ml-10" href="/writing">Writing</a><a href="/resume.pdf" class="text-white text-md opacity-80 hover:opacity-100 transition-opacity ml-10">Resume</a></nav></header><nav class="mt-2 pl-8 flex sm:flex md:hidden flex-1 flex-row items-a"><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity mr-10" href="/#projects">Projects</a><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity mr-10" href="/writing">Writing</a><a href="/resume.pdf" class="text-white text-md opacity-80 hover:opacity-100 transition-opacity mr-10">Resume</a></nav></section><div class="py-10 px-8 max-w-6xl"><article><div class="post-header mb-8"><h1 class="text-3xl mb-1 font-semibold">Predicting Titanic Survivors: My First Machine Learning Model</h1><h3 class="text-md text-cyan uppercase mb-3 font-semibold">August 4, 2018</h3><a class="inline mr-2 py-1 px-2 rounded-sm bg-gray-800 text-white text-xs hover:text-gray-300" href="/writing?tag=Legacy%20Content">Legacy Content</a></div><main class="prose prose-invert max-w-none prose-pre:bg-transparent prose-pre:p-0 prose-code:before:content-[&#x27;&#x27;] prose-code:after:content-[&#x27;&#x27;] prose-p:text-white prose-a:text-cyan hover:prose-a:text-white hover:prose-a:underline prose-a:no-underline"><p>I&#x27;ve been taking the <a href="https://www.coursera.org/learn/machine-learning">Machine Learning course by Dr. Andrew Ng</a> online through Coursera, and so far it&#x27;s been an enlightening and enjoyable experience. While I&#x27;ve been taking lots of notes on the equations and implementation details on linear and logistic regression models, I thought it would be a fun weekend exercise to implement these algorithms from scratch using my favorite toolkit: Python, Pandas, and Numpy.</p>
<p>Special thanks to Dr. Ng and his course staff for preparing such high-quality course material. Many of these equations and explanations are based on notes from the course lectures, and I have paraphrased many of the explanations here in my own words as best as possible.</p>
<h2>The Dataset</h2>
<p>The dataset I decided to work with for this project was the was the <a href="https://www.kaggle.com/c/titanic">Kaggle Titanic dataset</a>, which was recommended as a beginner dataset to work with.</p>
<p><img src="/post-images/titanic-training.png" alt="Titanic Dataset Data"/></p>
<center><em><p><strong>Figure 1:</strong> Structure of the dataset</p></em></center>
<p>Based on the <code>train.csv</code> file included in the dataset download, it was clear that this was a binary classification problem. Since I only know how to implement linear and logistic regression models so far, I decided to use logistic regression for this problem.</p>
<h2>Project Structure</h2>
<p>For reference, my project directory was structured like this:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-text" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>.
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>├── Makefile
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>├── data
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span>│   ├── gender_submission.csv
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">5</span>│   ├── test.csv
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">6</span>│   └── train.csv
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">7</span>└── src
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">8</span>    └── Titanic.ipynb</span></code></div></pre>
<p>The <code>Makefile</code> in the main directory has a fake target to make launching <code>jupyter lab</code> easier.</p>
<h2>Preparing the Data</h2>
<p>I first needed to clean the data before I could use it. In order to do that, I first brought the data into a pandas <code>DataFrame</code>:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#c678dd">import</span><span> pandas </span><span style="color:#c678dd">as</span><span> pd
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>df = pd.read_csv(</span><span style="color:#98c379">&quot;../data/train.csv&quot;</span><span>)</span></span></code></div></pre>
<p>Then, I dropped the columns that I couldn&#x27;t convert into numbers:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>df = df.drop(columns=[</span><span style="color:#98c379">&#x27;Name&#x27;</span><span>, </span><span style="color:#98c379">&#x27;PassengerId&#x27;</span><span>, </span><span style="color:#98c379">&#x27;Ticket&#x27;</span><span>, </span><span style="color:#98c379">&#x27;Cabin&#x27;</span><span>])</span></span></code></div></pre>
<p><strong>Note:</strong> Having fewer features means the model was less accurate than it could be. Some clever feature engineering would have made use of these columns somehow, but as I was a beginner, I didn&#x27;t really know what to do with these features other than throw them out.</p>
<p>Next, I converted all of the textual features into numerical values roughly within the range <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(-1, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">−</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">sex_to_numerical</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">s</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>    </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">int</span><span>(g == </span><span style="color:#98c379">&quot;female&quot;</span><span>)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span></span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">embarkation_to_numerical</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">e</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>    </span><span style="color:#c678dd">if</span><span> (e == </span><span style="color:#98c379">&quot;C&quot;</span><span>):
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>        </span><span style="color:#c678dd">return</span><span> -</span><span style="color:#d19a66">1</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span>    </span><span style="color:#c678dd">elif</span><span> (e == </span><span style="color:#98c379">&quot;Q&quot;</span><span>):
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span>        </span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">0</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span>    </span><span style="color:#c678dd">else</span><span>:
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span>        </span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">1</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span>df.Sex = df.Sex.apply(sex_to_numerical)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span>df.Embarked = df.Embarked.apply(embarkation_to_numerical)</span></code></div></pre>
<p>I then normalized the data using a simple approach: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mtext>value</mtext><mo>−</mo><mtext>max</mtext><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mtext>range</mtext></mrow><annotation encoding="application/x-tex">(\text{value} - \text{max})/\text{range}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord text"><span class="mord">value</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">max</span></span><span class="mclose">)</span><span class="mord">/</span><span class="mord text"><span class="mord">range</span></span></span></span></span></span>
where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>range</mtext><mo>=</mo><mtext>max</mtext><mo>−</mo><mtext>min</mtext></mrow><annotation encoding="application/x-tex">\text{range} = \text{max} - \text{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord text"><span class="mord">range</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord text"><span class="mord">max</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6679em"></span><span class="mord text"><span class="mord">min</span></span></span></span></span></span>.</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">normalize_ticket_class</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">cl</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>    </span><span style="color:#c678dd">return</span><span> (cl - </span><span style="color:#d19a66">3</span><span>) / </span><span style="color:#d19a66">2</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span></span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">normalize_fare</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">farecol</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>    range_f = farecol.</span><span style="color:#e6c07b">max</span><span>() - farecol.</span><span style="color:#e6c07b">min</span><span>()
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>    max_f = farecol.</span><span style="color:#e6c07b">max</span><span>()
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span>    </span><span style="color:#c678dd">return</span><span> farecol.apply(</span><span style="color:#c678dd">lambda</span><span> fare: (fare - max_f)/range_f)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span>df.Fare = normalize_fare(df.Fare)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span>df.Pclass = df.Pclass.apply(normalize_ticket_class)</span></code></div></pre>
<p>I needed to convert all missing/<code>NaN</code> values in the <code>Age</code> column to numbers so that I didn&#x27;t need to throw that feature out:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">de_nan_age</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">a</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>    </span><span style="color:#c678dd">if</span><span> (np.isnan(a)):
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>        </span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">0.0</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>    </span><span style="color:#c678dd">else</span><span>:
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>        </span><span style="color:#c678dd">return</span><span> a
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>df.Age = df.Age.apply(de_nan_age)</span></code></div></pre>
<p>After all this processing, the <code>DataFrame</code> looks like this:</p>
<table><thead><tr><th>Index</th><th>Survived</th><th>Pclass</th><th>Sex</th><th>Age</th><th>SibSp</th><th>Parch</th><th>Fare</th><th>Embarked</th></tr></thead><tbody><tr><td>0</td><td>0</td><td>0.0</td><td>0</td><td>22.0</td><td>1</td><td>0</td><td>-0.985848942437792</td><td>1</td></tr><tr><td>1</td><td>1</td><td>-1.0</td><td>1</td><td>38.0</td><td>1</td><td>0</td><td>-0.8608642646173593</td><td>-1</td></tr><tr><td>2</td><td>1</td><td>0.0</td><td>1</td><td>26.0</td><td>0</td><td>0</td><td>-0.9845314301820002</td><td>1</td></tr><tr><td>3</td><td>1</td><td>-1.0</td><td>1</td><td>35.0</td><td>1</td><td>0</td><td>-0.8963557025443796</td><td>1</td></tr><tr><td>4</td><td>0</td><td>0.0</td><td>0</td><td>35.0</td><td>0</td><td>0</td><td>-0.9842874464309276</td><td>1</td></tr></tbody></table>
<p>Now, I&#x27;ll split up the <code>DataFrame</code> into two <code>np.array</code>s, one with the features, the other with the labels:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>features = df.drop(columns=[</span><span style="color:#98c379">&#x27;Survived&#x27;</span><span>]).values
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>labels = df.Survived.values</span></code></div></pre>
<p>Add an <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_0 = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span> column to the features array so everything looks clean:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>x_zero_column = np.zeros((features.shape[</span><span style="color:#d19a66">0</span><span>], </span><span style="color:#d19a66">1</span><span>)) + </span><span style="color:#d19a66">1</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>features = np.append(x_zero_column, features, axis=</span><span style="color:#d19a66">1</span><span>)</span></span></code></div></pre>
<p>Using the features and labels arrays, create a <em>design matrix</em> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> and the <em>label vector</em> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span>:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>X = np.asmatrix(features)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span></span><span style="color:#5c6370;font-style:italic"># y needs to be transposed from a row vector to a column vector</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span>y = np.asmatrix(labels).T</span></code></div></pre>
<p>The data is now ready to be used.</p>
<h2>Define Variables</h2>
<p>Using <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span>:, it&#x27;s time to define some variables that are important to the implmentation of the <em>cost function</em> <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span></span>:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># m is the number of training samples</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>m = X.shape[</span><span style="color:#d19a66">0</span><span>]
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span></span><span style="color:#5c6370;font-style:italic"># n is the number of features, in this case we are not counting the x_0 column</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>n = X.shape[</span><span style="color:#d19a66">1</span><span>] - </span><span style="color:#d19a66">1</span></span></code></div></pre>
<p>Let&#x27;s define the parameter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span> as a <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span>-dimensional vector, initially filled with zeros:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>theta = np.asmatrix(np.zeros(n + </span><span style="color:#d19a66">1</span><span>)).T</span></span></code></div></pre>
<p>And let&#x27;s set a learning rate <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span>, in this case I just chose an arbitrary value:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>alpha = </span><span style="color:#d19a66">0.001</span></span></code></div></pre>
<p>It&#x27;s important to choose the right <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span>, because a smaller value may make the model slower to converge, while a larger value might make the model never converge.</p>
<h2>Define Functions</h2>
<h3>The Sigmoid Function</h3>
<p>One of the most important equations needed for logistic regression is the sigmoid function, which looks like this:</p>
<center></center>
<p>The equation for the sigmoid function is</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">g(z) = \frac{1}{1+ e^{-z}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em"><span style="top:-2.989em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div>
<p>Thanks to numpy, it&#x27;s very simple to define an element-wise vectorized sigmoid function, which will our code much more efficient:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">sigmoid</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">z</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>    t = np.exp(-z) + </span><span style="color:#d19a66">1</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>    </span><span style="color:#c678dd">return</span><span> np.divide(</span><span style="color:#d19a66">1</span><span>, t)</span></span></code></div></pre>
<h3>The Hypothesis Function</h3>
<p>To generate a matrix of predictions using the parameter vector <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span>, we define our hypothesis function <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_{\theta}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> as follows:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_{\theta}(x) = g(X\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Xθ</span><span class="mclose">)</span></span></span></span></span></div>
<p>where <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span></span></span></span> is the design matrix.</p>
<p>But what does the output of this function mean? <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_{\theta}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> is actually outputting the <em>probability</em> that the output is 1.
Formally, this function gives you the probablility that <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">1</span></span></span></span></span>, given <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span>, parameterized by <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span> (mathematically, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(y=1|x;\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span></span></span></span></span>).</p>
<p>In Python, we can define the hypothesis function similarly:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">hypothesis</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">x</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>    </span><span style="color:#c678dd">return</span><span> sigmoid(x * theta)</span></span></code></div></pre>
<h3>The Cost Function</h3>
<p>In order for the logistic regression algorithm to <em>learn</em>, it must have some function to minimize. This function is called the <em>cost</em> or <em>loss</em> function.</p>
<p>For logistic regression, the cost function is defined as:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">(</mo><mo>−</mo><msup><mi>y</mi><mi>T</mi></msup><mi>log</mi><mo>⁡</mo><mrow><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>h</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mo fence="false" stretchy="true" minsize="2.4em" maxsize="2.4em">)</mo></mrow><annotation encoding="application/x-tex">J(\theta) = \frac{1}{m} \bigg(-y^T \log{h(x)}- (1-y^T)\log{(1-h(x))}\bigg)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="delimsizing size3">(</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.1413em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span><span class="mord"><span class="delimsizing size3">)</span></span></span></span></span></span></div>
<p>The Python code for this function came out to be too long to write out on one line, so the math is done on three separate lines.</p>
<p><strong>Note:</strong> <code>cost</code> came out to be a 1x1 numpy matrix and was converted into a singular floating-point value at the end.</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">cost</span><span class="hljs-function">():</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span>    hypo = hypothesis(X)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>    part1 = -(y.T) * np.log(hypo)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>    part2 = (</span><span style="color:#d19a66">1</span><span>-(y.T)) * np.log(</span><span style="color:#d19a66">1</span><span> - hypo)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>    cost = (</span><span style="color:#d19a66">1</span><span>/m) * (part1 - part2)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span>    </span><span style="color:#c678dd">return</span><span> cost[</span><span style="color:#d19a66">0</span><span>,</span><span style="color:#d19a66">0</span><span>]</span></span></code></div></pre>
<h3>The Gradient Descent Function</h3>
<p>The last (and probably most important) piece of this machine learning algorithm is the <code>gradient_descent_step</code> function, which calculates the gradient for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span>.</p>
<p>The update rule for <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span> is as follows:</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>θ</mi><mo>:</mo><mo>=</mo><mi>θ</mi><mo>−</mo><mfrac><mi>α</mi><mi>m</mi></mfrac><msup><mi>X</mi><mi>T</mi></msup><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>X</mi><mi>θ</mi><mo stretchy="false">)</mo><mo>−</mo><mover accent="true"><mi>y</mi><mo>⃗</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\theta := \theta - \frac{\alpha}{m}X^T(g(X\theta)-\vec{y})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">:=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.7936em;vertical-align:-0.686em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em">Xθ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.714em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1799em"><span class="overlay" style="height:0.714em;width:0.471em"><svg xmlns="http://www.w3.org/2000/svg" width="0.471em" height="0.714em" style="width:0.471em" viewBox="0 0 471 714" preserveAspectRatio="xMinYMin"><path d="M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z"></path></svg></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em"><span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></div>
<p>This is simple to implement in Python as a one-liner:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">gradient_descent_step</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">theta</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>    </span><span style="color:#c678dd">return</span><span> theta - (alpha/m)*(X.T)*(hypothesis(X) - y)</span></span></code></div></pre>
<p>With all the necessary functions implemented, it&#x27;s time to actually learn the parameters <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span>.</p>
<h2>Run the Learning Algorithm</h2>
<p>To run the learning algorithm, let&#x27;s create a loop in which <code>gradient_descent_step</code> is run every iteration:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#c678dd">for</span><span> i </span><span style="color:#c678dd">in</span><span> </span><span style="color:#e6c07b">range</span><span>(</span><span style="color:#d19a66">1630000</span><span>):
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>    theta = gradient_descent_step(theta)</span></code></div></pre>
<p>I found experimentally that after 1.63 million iterations, the cost delta after each iteration of Gradient Descent is negligible.</p>
<p>After the loop was run, the cost was approximately <code>0.45085533814736584</code>.</p>
<p>Before we do anything else, let&#x27;s save the optimal <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span></span></span></span></span> in a file:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>np.savetxt(</span><span style="color:#98c379">&quot;theta.txt&quot;</span><span>, theta)</span></span></code></div></pre>
<p>Once saved, it can be loaded back like this:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>theta = np.asmatrix(np.loadtxt(</span><span style="color:#98c379">&quot;theta.txt&quot;</span><span>))
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>theta = theta.T</span></code></div></pre>
<h2>Run the Model on Test Data</h2>
<h3>Create the Prediction Function</h3>
<p>Using the <code>hypothesis(x)</code> function, let&#x27;s define a function that outputs <code>1</code> if <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">;</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>≥</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">P(y=1|x;\theta) ≥ 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1∣</span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">0.5</span></span></span></span></span> or <code>0</code> otherwise:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span class="hljs-function" style="color:#c678dd">def</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">predict</span><span class="hljs-function">(</span><span class="hljs-function hljs-params">x</span><span class="hljs-function">):</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>    h = hypothesis(x)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>    comp = (h &gt;= </span><span style="color:#d19a66">0.5</span><span>)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>    </span><span style="color:#c678dd">return</span><span> comp.astype(</span><span style="color:#e6c07b">int</span><span>)</span></span></code></div></pre>
<p><code>predict(x)</code> runs predictions on a matrix element-wise and converts them into numerical binary values.</p>
<h3>Import the Test Data</h3>
<p>Now, it&#x27;s time to bring in the test data, preparing it like we did for the training data:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>test_df = pd.read_csv(</span><span style="color:#98c379">&quot;../data/test.csv&quot;</span><span>)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>test_df = test_df.drop(columns=[</span><span style="color:#98c379">&#x27;Name&#x27;</span><span>, </span><span style="color:#98c379">&#x27;PassengerId&#x27;</span><span>, </span><span style="color:#98c379">&#x27;Ticket&#x27;</span><span>, </span><span style="color:#98c379">&#x27;Cabin&#x27;</span><span>])
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>test_df.Pclass = test_df.Pclass.apply(normalize_ticket_class)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>test_df.Sex = test_df.Sex.apply(sex_to_numerical)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>test_df.Fare = normalize_fare(test_df.Fare)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span>test_df.Embarked = test_df.Embarked.apply(embarkation_to_numerical)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span>test_df.Age = test_df.Age.apply(de_nan_age)</span></code></div></pre>
<p>Let&#x27;s add in the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">x_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> column like before:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>test_X = test_df.values
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>x_zero_column_test = np.zeros((test_df.shape[</span><span style="color:#d19a66">0</span><span>], </span><span style="color:#d19a66">1</span><span>)) + </span><span style="color:#d19a66">1</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>test_X = np.append(x_zero_column_test, test_X, axis=</span><span style="color:#d19a66">1</span><span>)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>test_X = np.asmatrix(test_X)</span></code></div></pre>
<h3>Generate Predictions</h3>
<p>Using the <code>test_X</code> matrix, let&#x27;s generate predictions and save them to a file:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>predictions = predict(test_X)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>np.savetxt(</span><span style="color:#98c379">&quot;predictions.txt&quot;</span><span>, predictions)</span></span></code></div></pre>
<h3>Prepare Submission For Kaggle</h3>
<p>The <code>predictions.txt</code> file isn&#x27;t in the format that Kaggle needs for submission. Let&#x27;s put our predictions into a pandas <code>DataFrame</code> along with the <code>PassengerId</code> column:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># Function to flatten nested lists</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>flatten = </span><span style="color:#c678dd">lambda</span><span> l: [item </span><span style="color:#c678dd">for</span><span> sublist </span><span style="color:#c678dd">in</span><span> l </span><span style="color:#c678dd">for</span><span> item </span><span style="color:#c678dd">in</span><span> sublist]
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span></span><span style="color:#5c6370;font-style:italic"># Temp DataFrame to get PassengerIds</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>temp_df = pd.read_csv(</span><span style="color:#98c379">&quot;../data/test.csv&quot;</span><span>)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span>submission_df = pd.DataFrame()
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span>submission_df[</span><span style="color:#98c379">&quot;PassengerId&quot;</span><span>] = temp_df[</span><span style="color:#98c379">&quot;PassengerId&quot;</span><span>]
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span>submission_df[</span><span style="color:#98c379">&quot;Survived&quot;</span><span>] = pd.Series(flatten(predictions.flatten().tolist()))</span></span></code></div></pre>
<p>Let&#x27;s export to CSV for upload to Kaggle:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>submission_df.to_csv(</span><span style="color:#98c379">&quot;kaggle_submission.csv&quot;</span><span>, index=</span><span style="color:#56b6c2">False</span><span>)</span></span></code></div></pre>
<h2>Results</h2>
<p>According to Kaggle&#x27;s online judge, my model had an accuracy of 74.641% on the test dataset, which is not great by machine learning standards, but was nevertheless exciting for me, since I implemented the model (almost) from scratch.</p>
<p>This was an improvement over my submission from last year, which was a linear regression algorithm using <code>scikit-learn</code>.</p>
<p><img src="/post-images/kaggle-score-logistic.png" alt="Kaggle leaderboard screenshot"/></p>
<center><em><p><strong>Figure 2:</strong> Pics or it didn&#x27;t happen</p></em></center>
<h2>Conclusion</h2>
<p>This project was also a chance to dip my toes into creating Machine Learning models for use on real data, taking the theory and applying it to a real-world problem.</p>
<p>Based on my results, I can also conclude that feature engineering (such as using polynomial features) may be needed to achieve a higher accuracy. Additionally, using something like neural networks may be a better option to achieve higher accuracy, due to their ability to learn complex nonlinear hypotheses.</p>
<p>If you are a machine learning expert and have suggestions on how I could improve the accuracy of my toy model, I would love to hear them! Comment on the Hacker News thread linked below or email me at the address below.</p>
<p><a href="https://news.ycombinator.com/item?id=17692378">Discuss on Hacker News</a></p></main></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\n/*\u003cDesmos url=\"https://www.desmos.com/calculator/hvlhutwrba?embed\" /\u003e*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    h2: \"h2\",\n    img: \"img\",\n    code: \"code\",\n    pre: \"pre\",\n    strong: \"strong\",\n    span: \"span\",\n    math: \"math\",\n    semantics: \"semantics\",\n    mrow: \"mrow\",\n    mo: \"mo\",\n    mn: \"mn\",\n    annotation: \"annotation\",\n    mtext: \"mtext\",\n    mi: \"mi\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    msub: \"msub\",\n    em: \"em\",\n    h3: \"h3\",\n    div: \"div\",\n    mfrac: \"mfrac\",\n    msup: \"msup\",\n    mover: \"mover\",\n    svg: \"svg\",\n    path: \"path\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"I've been taking the \", _jsx(_components.a, {\n        href: \"https://www.coursera.org/learn/machine-learning\",\n        children: \"Machine Learning course by Dr. Andrew Ng\"\n      }), \" online through Coursera, and so far it's been an enlightening and enjoyable experience. While I've been taking lots of notes on the equations and implementation details on linear and logistic regression models, I thought it would be a fun weekend exercise to implement these algorithms from scratch using my favorite toolkit: Python, Pandas, and Numpy.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Special thanks to Dr. Ng and his course staff for preparing such high-quality course material. Many of these equations and explanations are based on notes from the course lectures, and I have paraphrased many of the explanations here in my own words as best as possible.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"The Dataset\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The dataset I decided to work with for this project was the was the \", _jsx(_components.a, {\n        href: \"https://www.kaggle.com/c/titanic\",\n        children: \"Kaggle Titanic dataset\"\n      }), \", which was recommended as a beginner dataset to work with.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/post-images/titanic-training.png\",\n        alt: \"Titanic Dataset Data\"\n      })\n    }), \"\\n\", _jsx(\"center\", {\n      children: _jsx(\"em\", {\n        children: _jsxs(_components.p, {\n          children: [_jsx(\"strong\", {\n            children: \"Figure 1:\"\n          }), \" Structure of the dataset\"]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Based on the \", _jsx(_components.code, {\n        children: \"train.csv\"\n      }), \" file included in the dataset download, it was clear that this was a binary classification problem. Since I only know how to implement linear and logistic regression models so far, I decided to use logistic regression for this problem.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Project Structure\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For reference, my project directory was structured like this:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-text\",\n        children: \".\\n├── Makefile\\n├── data\\n│   ├── gender_submission.csv\\n│   ├── test.csv\\n│   └── train.csv\\n└── src\\n    └── Titanic.ipynb\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"Makefile\"\n      }), \" in the main directory has a fake target to make launching \", _jsx(_components.code, {\n        children: \"jupyter lab\"\n      }), \" easier.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Preparing the Data\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I first needed to clean the data before I could use it. In order to do that, I first brought the data into a pandas \", _jsx(_components.code, {\n        children: \"DataFrame\"\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"import pandas as pd\\ndf = pd.read_csv(\\\"../data/train.csv\\\")\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Then, I dropped the columns that I couldn't convert into numbers:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"df = df.drop(columns=['Name', 'PassengerId', 'Ticket', 'Cabin'])\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Note:\"\n      }), \" Having fewer features means the model was less accurate than it could be. Some clever feature engineering would have made use of these columns somehow, but as I was a beginner, I didn't really know what to do with these features other than throw them out.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Next, I converted all of the textual features into numerical values roughly within the range \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mo, {\n                    separator: \"true\",\n                    children: \",\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"(-1, 1)\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              }), _jsx(_components.span, {\n                className: \"mpunct\",\n                children: \",\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })\n          })]\n        })\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def sex_to_numerical(s):\\n    return int(g == \\\"female\\\")\\ndef embarkation_to_numerical(e):\\n    if (e == \\\"C\\\"):\\n        return -1\\n    elif (e == \\\"Q\\\"):\\n        return 0\\n    else:\\n        return 1\\ndf.Sex = df.Sex.apply(sex_to_numerical)\\ndf.Embarked = df.Embarked.apply(embarkation_to_numerical)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I then normalized the data using a simple approach: \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mtext, {\n                    children: \"value\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsx(_components.mtext, {\n                    children: \"max\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mi, {\n                    mathvariant: \"normal\",\n                    children: \"/\"\n                  }), _jsx(_components.mtext, {\n                    children: \"range\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"(\\\\text{value} - \\\\text{max})/\\\\text{range}\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"value\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"max\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"/\"\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"range\"\n                })\n              })]\n            })]\n          })]\n        })\n      }), \"\\nwhere \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mtext, {\n                    children: \"range\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mtext, {\n                    children: \"max\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsx(_components.mtext, {\n                    children: \"min\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\text{range} = \\\\text{max} - \\\\text{min}\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.625em\",\n                  verticalAlign: \"-0.1944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"range\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6667em\",\n                  verticalAlign: \"-0.0833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"max\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6679em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord text\",\n                children: _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"min\"\n                })\n              })]\n            })]\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def normalize_ticket_class(cl):\\n    return (cl - 3) / 2\\ndef normalize_fare(farecol):\\n    range_f = farecol.max() - farecol.min()\\n    max_f = farecol.max()\\n    return farecol.apply(lambda fare: (fare - max_f)/range_f)\\ndf.Fare = normalize_fare(df.Fare)\\ndf.Pclass = df.Pclass.apply(normalize_ticket_class)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"I needed to convert all missing/\", _jsx(_components.code, {\n        children: \"NaN\"\n      }), \" values in the \", _jsx(_components.code, {\n        children: \"Age\"\n      }), \" column to numbers so that I didn't need to throw that feature out:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def de_nan_age(a):\\n    if (np.isnan(a)):\\n        return 0.0\\n    else:\\n        return a\\ndf.Age = df.Age.apply(de_nan_age)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"After all this processing, the \", _jsx(_components.code, {\n        children: \"DataFrame\"\n      }), \" looks like this:\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"Index\"\n          }), _jsx(_components.th, {\n            children: \"Survived\"\n          }), _jsx(_components.th, {\n            children: \"Pclass\"\n          }), _jsx(_components.th, {\n            children: \"Sex\"\n          }), _jsx(_components.th, {\n            children: \"Age\"\n          }), _jsx(_components.th, {\n            children: \"SibSp\"\n          }), _jsx(_components.th, {\n            children: \"Parch\"\n          }), _jsx(_components.th, {\n            children: \"Fare\"\n          }), _jsx(_components.th, {\n            children: \"Embarked\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0.0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"22.0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"-0.985848942437792\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"-1.0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"38.0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"-0.8608642646173593\"\n          }), _jsx(_components.td, {\n            children: \"-1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"2\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0.0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"26.0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"-0.9845314301820002\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"3\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"-1.0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"35.0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"-0.8963557025443796\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"4\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0.0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"35.0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"-0.9842874464309276\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now, I'll split up the \", _jsx(_components.code, {\n        children: \"DataFrame\"\n      }), \" into two \", _jsx(_components.code, {\n        children: \"np.array\"\n      }), \"s, one with the features, the other with the labels:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"features = df.drop(columns=['Survived']).values\\nlabels = df.Survived.values\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Add an \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mn, {\n                      children: \"0\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x_0 = 1\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.5806em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"0\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              })]\n            })]\n          })]\n        })\n      }), \" column to the features array so everything looks clean:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"x_zero_column = np.zeros((features.shape[0], 1)) + 1\\nfeatures = np.append(x_zero_column, features, axis=1)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Using the features and labels arrays, create a \", _jsx(_components.em, {\n        children: \"design matrix\"\n      }), \" \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"X\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"X\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.07847em\"\n                },\n                children: \"X\"\n              })]\n            })\n          })]\n        })\n      }), \" and the \", _jsx(_components.em, {\n        children: \"label vector\"\n      }), \" \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"y\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"y\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.625em\",\n                  verticalAlign: \"-0.1944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              })]\n            })\n          })]\n        })\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"X = np.asmatrix(features)\\n# y needs to be transposed from a row vector to a column vector\\ny = np.asmatrix(labels).T\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The data is now ready to be used.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Define Variables\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Using \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"X\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"X\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.07847em\"\n                },\n                children: \"X\"\n              })]\n            })\n          })]\n        })\n      }), \" and \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"y\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"y\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.625em\",\n                  verticalAlign: \"-0.1944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              })]\n            })\n          })]\n        })\n      }), \":, it's time to define some variables that are important to the implmentation of the \", _jsx(_components.em, {\n        children: \"cost function\"\n      }), \" \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"J\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"J\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.09618em\"\n                },\n                children: \"J\"\n              })]\n            })\n          })]\n        })\n      }), \":\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"# m is the number of training samples\\nm = X.shape[0]\\n# n is the number of features, in this case we are not counting the x_0 column\\nn = X.shape[1] - 1\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's define the parameter \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \" as a \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"n\"\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"n+1\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6667em\",\n                  verticalAlign: \"-0.0833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"n\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              })]\n            })]\n          })]\n        })\n      }), \"-dimensional vector, initially filled with zeros:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"theta = np.asmatrix(np.zeros(n + 1)).T\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"And let's set a learning rate \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"α\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\alpha\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.0037em\"\n                },\n                children: \"α\"\n              })]\n            })\n          })]\n        })\n      }), \", in this case I just chose an arbitrary value:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"alpha = 0.001\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"It's important to choose the right \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"α\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\alpha\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.0037em\"\n                },\n                children: \"α\"\n              })]\n            })\n          })]\n        })\n      }), \", because a smaller value may make the model slower to converge, while a larger value might make the model never converge.\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Define Functions\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"The Sigmoid Function\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"One of the most important equations needed for logistic regression is the sigmoid function, which looks like this:\"\n    }), \"\\n\", _jsx(\"center\", {}), \"\\n\", _jsx(_components.p, {\n      children: \"The equation for the sigmoid function is\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"math math-display\",\n      children: _jsx(_components.span, {\n        className: \"katex-display\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              display: \"block\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"g\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"z\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsx(_components.mn, {\n                      children: \"1\"\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mn, {\n                        children: \"1\"\n                      }), _jsx(_components.mo, {\n                        children: \"+\"\n                      }), _jsxs(_components.msup, {\n                        children: [_jsx(_components.mi, {\n                          children: \"e\"\n                        }), _jsxs(_components.mrow, {\n                          children: [_jsx(_components.mo, {\n                            children: \"−\"\n                          }), _jsx(_components.mi, {\n                            children: \"z\"\n                          })]\n                        })]\n                      })]\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"g(z) = \\\\frac{1}{1+ e^{-z}}\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"g\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.04398em\"\n                },\n                children: \"z\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"2.0908em\",\n                  verticalAlign: \"-0.7693em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.3214em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"1\"\n                            }), _jsx(_components.span, {\n                              className: \"mspace\",\n                              style: {\n                                marginRight: \"0.2222em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"mbin\",\n                              children: \"+\"\n                            }), _jsx(_components.span, {\n                              className: \"mspace\",\n                              style: {\n                                marginRight: \"0.2222em\"\n                              }\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal\",\n                                children: \"e\"\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsx(_components.span, {\n                                  className: \"vlist-t\",\n                                  children: _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.6973em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.989em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsxs(_components.span, {\n                                            className: \"mord mtight\",\n                                            children: [_jsx(_components.span, {\n                                              className: \"mord mtight\",\n                                              children: \"−\"\n                                            }), _jsx(_components.span, {\n                                              className: \"mord mathnormal mtight\",\n                                              style: {\n                                                marginRight: \"0.04398em\"\n                                              },\n                                              children: \"z\"\n                                            })]\n                                          })\n                                        })]\n                                      })\n                                    })\n                                  })\n                                })\n                              })]\n                            })]\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            children: _jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"1\"\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.7693em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Thanks to numpy, it's very simple to define an element-wise vectorized sigmoid function, which will our code much more efficient:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def sigmoid(z):\\n    t = np.exp(-z) + 1\\n    return np.divide(1, t)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"The Hypothesis Function\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To generate a matrix of predictions using the parameter vector \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \", we define our hypothesis function \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"h_{\\\\theta}(x)\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3361em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.02778em\"\n                                },\n                                children: \"θ\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })\n          })]\n        })\n      }), \" as follows:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"math math-display\",\n      children: _jsx(_components.span, {\n        className: \"katex-display\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              display: \"block\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"g\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"X\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"h_{\\\\theta}(x) = g(X\\\\theta)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3361em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.02778em\"\n                                },\n                                children: \"θ\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"g\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"Xθ\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"where \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"X\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"X\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.07847em\"\n                },\n                children: \"X\"\n              })]\n            })\n          })]\n        })\n      }), \" is the design matrix.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"But what does the output of this function mean? \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mi, {\n                      children: \"θ\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"h_{\\\\theta}(x)\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3361em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mathnormal mtight\",\n                                style: {\n                                  marginRight: \"0.02778em\"\n                                },\n                                children: \"θ\"\n                              })\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })\n          })]\n        })\n      }), \" is actually outputting the \", _jsx(_components.em, {\n        children: \"probability\"\n      }), \" that the output is 1.\\nFormally, this function gives you the probablility that \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"y\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"y=1\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.625em\",\n                  verticalAlign: \"-0.1944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              })]\n            })]\n          })]\n        })\n      }), \", given \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"x\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.4306em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              })]\n            })\n          })]\n        })\n      }), \", parameterized by \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \" (mathematically, \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"P\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"y\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mi, {\n                    mathvariant: \"normal\",\n                    children: \"∣\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    separator: \"true\",\n                    children: \";\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"P(y=1|x;\\\\theta)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.13889em\"\n                },\n                children: \"P\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1∣\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mpunct\",\n                children: \";\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })]\n          })]\n        })\n      }), \").\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"In Python, we can define the hypothesis function similarly:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def hypothesis(x):\\n    return sigmoid(x * theta)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"The Cost Function\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"In order for the logistic regression algorithm to \", _jsx(_components.em, {\n        children: \"learn\"\n      }), \", it must have some function to minimize. This function is called the \", _jsx(_components.em, {\n        children: \"cost\"\n      }), \" or \", _jsx(_components.em, {\n        children: \"loss\"\n      }), \" function.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"For logistic regression, the cost function is defined as:\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"math math-display\",\n      children: _jsx(_components.span, {\n        className: \"katex-display\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              display: \"block\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"J\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsx(_components.mn, {\n                      children: \"1\"\n                    }), _jsx(_components.mi, {\n                      children: \"m\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    fence: \"false\",\n                    stretchy: \"true\",\n                    minsize: \"2.4em\",\n                    maxsize: \"2.4em\",\n                    children: \"(\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"y\"\n                    }), _jsx(_components.mi, {\n                      children: \"T\"\n                    })]\n                  }), _jsx(_components.mi, {\n                    children: \"log\"\n                  }), _jsx(_components.mo, {\n                    children: \"⁡\"\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"y\"\n                    }), _jsx(_components.mi, {\n                      children: \"T\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mi, {\n                    children: \"log\"\n                  }), _jsx(_components.mo, {\n                    children: \"⁡\"\n                  }), _jsxs(_components.mrow, {\n                    children: [_jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mn, {\n                      children: \"1\"\n                    }), _jsx(_components.mo, {\n                      children: \"−\"\n                    }), _jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \"(\"\n                    }), _jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    }), _jsx(_components.mo, {\n                      stretchy: \"false\",\n                      children: \")\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    fence: \"false\",\n                    stretchy: \"true\",\n                    minsize: \"2.4em\",\n                    maxsize: \"2.4em\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"J(\\\\theta) = \\\\frac{1}{m} \\\\bigg(-y^T \\\\log{h(x)}- (1-y^T)\\\\log{(1-h(x))}\\\\bigg)\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.09618em\"\n                },\n                children: \"J\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"2.4em\",\n                  verticalAlign: \"-0.95em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.3214em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              children: \"m\"\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            children: _jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"1\"\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.686em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: _jsx(_components.span, {\n                  className: \"delimsizing size3\",\n                  children: \"(\"\n                })\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.1413em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.03588em\"\n                  },\n                  children: \"y\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8913em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.113em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              style: {\n                                marginRight: \"0.13889em\"\n                              },\n                              children: \"T\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mop\",\n                children: [\"lo\", _jsx(_components.span, {\n                  style: {\n                    marginRight: \"0.01389em\"\n                  },\n                  children: \"g\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \")\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"2.4em\",\n                  verticalAlign: \"-0.95em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.03588em\"\n                  },\n                  children: \"y\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8913em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.113em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              style: {\n                                marginRight: \"0.13889em\"\n                              },\n                              children: \"T\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mop\",\n                children: [\"lo\", _jsx(_components.span, {\n                  style: {\n                    marginRight: \"0.01389em\"\n                  },\n                  children: \"g\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"1\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mbin\",\n                  children: \"−\"\n                }), _jsx(_components.span, {\n                  className: \"mspace\",\n                  style: {\n                    marginRight: \"0.2222em\"\n                  }\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"mopen\",\n                  children: \"(\"\n                }), _jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"mclose\",\n                  children: \"))\"\n                })]\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: _jsx(_components.span, {\n                  className: \"delimsizing size3\",\n                  children: \")\"\n                })\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Python code for this function came out to be too long to write out on one line, so the math is done on three separate lines.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.strong, {\n        children: \"Note:\"\n      }), \" \", _jsx(_components.code, {\n        children: \"cost\"\n      }), \" came out to be a 1x1 numpy matrix and was converted into a singular floating-point value at the end.\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def cost():\\n    hypo = hypothesis(X)\\n    part1 = -(y.T) * np.log(hypo)\\n    part2 = (1-(y.T)) * np.log(1 - hypo)\\n    cost = (1/m) * (part1 - part2)\\n    return cost[0,0]\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"The Gradient Descent Function\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The last (and probably most important) piece of this machine learning algorithm is the \", _jsx(_components.code, {\n        children: \"gradient_descent_step\"\n      }), \" function, which calculates the gradient for \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The update rule for \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \" is as follows:\"]\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"math math-display\",\n      children: _jsx(_components.span, {\n        className: \"katex-display\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              display: \"block\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    children: \":\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsx(_components.mi, {\n                      children: \"α\"\n                    }), _jsx(_components.mi, {\n                      children: \"m\"\n                    })]\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mi, {\n                      children: \"X\"\n                    }), _jsx(_components.mi, {\n                      children: \"T\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"g\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"X\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"−\"\n                  }), _jsxs(_components.mover, {\n                    accent: \"true\",\n                    children: [_jsx(_components.mi, {\n                      children: \"y\"\n                    }), _jsx(_components.mo, {\n                      children: \"⃗\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta := \\\\theta - \\\\frac{\\\\alpha}{m}X^T(g(X\\\\theta)-\\\\vec{y})\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \":=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.7778em\",\n                  verticalAlign: \"-0.0833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1.7936em\",\n                  verticalAlign: \"-0.686em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.1076em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              children: \"m\"\n                            })\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"mord\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal\",\n                              style: {\n                                marginRight: \"0.0037em\"\n                              },\n                              children: \"α\"\n                            })\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.686em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07847em\"\n                  },\n                  children: \"X\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8913em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.113em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mathnormal mtight\",\n                              style: {\n                                marginRight: \"0.13889em\"\n                              },\n                              children: \"T\"\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"g\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"Xθ\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"−\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord accent\",\n                children: _jsxs(_components.span, {\n                  className: \"vlist-t vlist-t2\",\n                  children: [_jsxs(_components.span, {\n                    className: \"vlist-r\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.714em\"\n                      },\n                      children: [_jsxs(_components.span, {\n                        style: {\n                          top: \"-3em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"mord mathnormal\",\n                          style: {\n                            marginRight: \"0.03588em\"\n                          },\n                          children: \"y\"\n                        })]\n                      }), _jsxs(_components.span, {\n                        style: {\n                          top: \"-3em\"\n                        },\n                        children: [_jsx(_components.span, {\n                          className: \"pstrut\",\n                          style: {\n                            height: \"3em\"\n                          }\n                        }), _jsx(_components.span, {\n                          className: \"accent-body\",\n                          style: {\n                            left: \"-0.1799em\"\n                          },\n                          children: _jsx(_components.span, {\n                            className: \"overlay\",\n                            style: {\n                              height: \"0.714em\",\n                              width: \"0.471em\"\n                            },\n                            children: _jsx(_components.svg, {\n                              xmlns: \"http://www.w3.org/2000/svg\",\n                              width: \"0.471em\",\n                              height: \"0.714em\",\n                              style: {\n                                width: \"0.471em\"\n                              },\n                              viewBox: \"0 0 471 714\",\n                              preserveAspectRatio: \"xMinYMin\",\n                              children: _jsx(_components.path, {\n                                d: \"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\\nc-16-25.333-24-45-24-59z\"\n                              })\n                            })\n                          })\n                        })]\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-s\",\n                      children: \"​\"\n                    })]\n                  }), _jsx(_components.span, {\n                    className: \"vlist-r\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist\",\n                      style: {\n                        height: \"0.1944em\"\n                      },\n                      children: _jsx(_components.span, {})\n                    })\n                  })]\n                })\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This is simple to implement in Python as a one-liner:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def gradient_descent_step(theta):\\n    return theta - (alpha/m)*(X.T)*(hypothesis(X) - y)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"With all the necessary functions implemented, it's time to actually learn the parameters \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Run the Learning Algorithm\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"To run the learning algorithm, let's create a loop in which \", _jsx(_components.code, {\n        children: \"gradient_descent_step\"\n      }), \" is run every iteration:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"for i in range(1630000):\\n    theta = gradient_descent_step(theta)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"I found experimentally that after 1.63 million iterations, the cost delta after each iteration of Gradient Descent is negligible.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"After the loop was run, the cost was approximately \", _jsx(_components.code, {\n        children: \"0.45085533814736584\"\n      }), \".\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Before we do anything else, let's save the optimal \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsx(_components.mi, {\n                    children: \"θ\"\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"\\\\theta\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6944em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              })]\n            })\n          })]\n        })\n      }), \" in a file:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"np.savetxt(\\\"theta.txt\\\", theta)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Once saved, it can be loaded back like this:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"theta = np.asmatrix(np.loadtxt(\\\"theta.txt\\\"))\\ntheta = theta.T\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Run the Model on Test Data\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Create the Prediction Function\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Using the \", _jsx(_components.code, {\n        children: \"hypothesis(x)\"\n      }), \" function, let's define a function that outputs \", _jsx(_components.code, {\n        children: \"1\"\n      }), \" if \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"P\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"y\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mi, {\n                    mathvariant: \"normal\",\n                    children: \"∣\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    separator: \"true\",\n                    children: \";\"\n                  }), _jsx(_components.mi, {\n                    children: \"θ\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"≥\"\n                  }), _jsx(_components.mn, {\n                    children: \"0.5\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"P(y=1|x;\\\\theta) ≥ 0.5\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.13889em\"\n                },\n                children: \"P\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.03588em\"\n                },\n                children: \"y\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1∣\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mpunct\",\n                children: \";\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.02778em\"\n                },\n                children: \"θ\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"≥\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6444em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"0.5\"\n              })]\n            })]\n          })]\n        })\n      }), \" or \", _jsx(_components.code, {\n        children: \"0\"\n      }), \" otherwise:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"def predict(x):\\n    h = hypothesis(x)\\n    comp = (h \u003e= 0.5)\\n    return comp.astype(int)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.code, {\n        children: \"predict(x)\"\n      }), \" runs predictions on a matrix element-wise and converts them into numerical binary values.\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Import the Test Data\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, it's time to bring in the test data, preparing it like we did for the training data:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"test_df = pd.read_csv(\\\"../data/test.csv\\\")\\ntest_df = test_df.drop(columns=['Name', 'PassengerId', 'Ticket', 'Cabin'])\\ntest_df.Pclass = test_df.Pclass.apply(normalize_ticket_class)\\ntest_df.Sex = test_df.Sex.apply(sex_to_numerical)\\ntest_df.Fare = normalize_fare(test_df.Fare)\\ntest_df.Embarked = test_df.Embarked.apply(embarkation_to_numerical)\\ntest_df.Age = test_df.Age.apply(de_nan_age)\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Let's add in the \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"x\"\n                    }), _jsx(_components.mn, {\n                      children: \"0\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"x_0\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.5806em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"x\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"0\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \" column like before:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"test_X = test_df.values\\nx_zero_column_test = np.zeros((test_df.shape[0], 1)) + 1\\ntest_X = np.append(x_zero_column_test, test_X, axis=1)\\ntest_X = np.asmatrix(test_X)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Generate Predictions\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Using the \", _jsx(_components.code, {\n        children: \"test_X\"\n      }), \" matrix, let's generate predictions and save them to a file:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"predictions = predict(test_X)\\nnp.savetxt(\\\"predictions.txt\\\", predictions)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Prepare Submission For Kaggle\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"The \", _jsx(_components.code, {\n        children: \"predictions.txt\"\n      }), \" file isn't in the format that Kaggle needs for submission. Let's put our predictions into a pandas \", _jsx(_components.code, {\n        children: \"DataFrame\"\n      }), \" along with the \", _jsx(_components.code, {\n        children: \"PassengerId\"\n      }), \" column:\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"# Function to flatten nested lists\\nflatten = lambda l: [item for sublist in l for item in sublist]\\n# Temp DataFrame to get PassengerIds\\ntemp_df = pd.read_csv(\\\"../data/test.csv\\\")\\nsubmission_df = pd.DataFrame()\\nsubmission_df[\\\"PassengerId\\\"] = temp_df[\\\"PassengerId\\\"]\\nsubmission_df[\\\"Survived\\\"] = pd.Series(flatten(predictions.flatten().tolist()))\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's export to CSV for upload to Kaggle:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-python\",\n        children: \"submission_df.to_csv(\\\"kaggle_submission.csv\\\", index=False)\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Results\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"According to Kaggle's online judge, my model had an accuracy of 74.641% on the test dataset, which is not great by machine learning standards, but was nevertheless exciting for me, since I implemented the model (almost) from scratch.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"This was an improvement over my submission from last year, which was a linear regression algorithm using \", _jsx(_components.code, {\n        children: \"scikit-learn\"\n      }), \".\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/post-images/kaggle-score-logistic.png\",\n        alt: \"Kaggle leaderboard screenshot\"\n      })\n    }), \"\\n\", _jsx(\"center\", {\n      children: _jsx(\"em\", {\n        children: _jsxs(_components.p, {\n          children: [_jsx(\"strong\", {\n            children: \"Figure 2:\"\n          }), \" Pics or it didn't happen\"]\n        })\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Conclusion\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"This project was also a chance to dip my toes into creating Machine Learning models for use on real data, taking the theory and applying it to a real-world problem.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Based on my results, I can also conclude that feature engineering (such as using polynomial features) may be needed to achieve a higher accuracy. Additionally, using something like neural networks may be a better option to achieve higher accuracy, due to their ability to learn complex nonlinear hypotheses.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"If you are a machine learning expert and have suggestions on how I could improve the accuracy of my toy model, I would love to hear them! Comment on the Hacker News thread linked below or email me at the address below.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.a, {\n        href: \"https://news.ycombinator.com/item?id=17692378\",\n        children: \"Discuss on Hacker News\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{"title":"Predicting Titanic Survivors: My First Machine Learning Model","description":"Learn how to build a machine learning model to predict Titanic survivors based on the Kaggle dataset.","displayDate":"August 4, 2018","date":1533423600000,"tags":["Legacy Content"]}},"frontMatter":{"title":"Predicting Titanic Survivors: My First Machine Learning Model","description":"Learn how to build a machine learning model to predict Titanic survivors based on the Kaggle dataset.","displayDate":"August 4, 2018","date":1533423600000,"tags":["Legacy Content"]}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"predicting-titanic-survivors"},"buildId":"jnr1Acdo_7E6QFZUGdTBG","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>