<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Aditya Rathod | Analyzing Browser History Using Python and Pandas</title><meta name="robots" content="index,follow"/><meta name="description" content="Explore the depths of your browser history with this introductory data science tutorial."/><meta property="og:title" content="Aditya Rathod | Analyzing Browser History Using Python and Pandas"/><meta property="og:description" content="Explore the depths of your browser history with this introductory data science tutorial."/><meta property="og:type" content="article"/><meta property="article:published_time" content="2017-11-12T20:00:00.000Z"/><meta name="next-head-count" content="9"/><link rel="preload" href="/_next/static/css/dd67a8de90d82862.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dd67a8de90d82862.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/_next/static/chunks/main-b6ae7f85f00af153.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1b961b81afafe8a2.js" defer=""></script><script src="/_next/static/chunks/675-8610370ef62a12c1.js" defer=""></script><script src="/_next/static/chunks/845-4fd11481df1204c1.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-c0bf3d55c00ed0d2.js" defer=""></script><script src="/_next/static/aSyoPV7O50QT6mPbepoKW/_buildManifest.js" defer=""></script><script src="/_next/static/aSyoPV7O50QT6mPbepoKW/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section><div class="w-full bg-cyan h-[3px]"></div><header class="mt-3 px-8 py-3 mx-auto flex flex-row items-center justify-between sm:justify-between md:justify-start lg:justify-start xl:justify-start"><div class="mr-0 sm:mr-0 md:mr-8 lg:mr-10 xl:mr-10 text-center"><a class="font-bold text-2xl text-white opacity-100 hover:opacity-80" href="/">Aditya Rathod<span class="text-spring">.</span></a></div><div class="flex-1"></div><nav class="hidden sm:hidden md:flex lg:flex xl:flex flaex-1 flex-row items-center"><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity ml-10" href="/#projects">Projects</a><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity ml-10" href="/writing">Writing</a><a href="/resume.pdf" class="text-white text-md opacity-80 hover:opacity-100 transition-opacity ml-10">Resume</a></nav></header><nav class="mt-2 pl-8 flex sm:flex md:hidden flex-1 flex-row items-a"><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity mr-10" href="/#projects">Projects</a><a class="text-white text-md opacity-80 hover:opacity-100 transition-opacity mr-10" href="/writing">Writing</a><a href="/resume.pdf" class="text-white text-md opacity-80 hover:opacity-100 transition-opacity mr-10">Resume</a></nav></section><div class="py-10 px-8 max-w-6xl"><article><div class="post-header mb-8"><h1 class="text-3xl mb-1 font-semibold">Analyzing Browser History Using Python and Pandas</h1><h3 class="text-md text-cyan uppercase mb-3 font-semibold">November 12, 2017</h3><a class="inline mr-2 py-1 px-2 rounded-sm bg-gray-800 text-white text-xs hover:text-gray-300" href="/writing?tag=Legacy%20Content">Legacy Content</a></div><main class="prose prose-invert max-w-none prose-pre:bg-transparent prose-pre:p-0 prose-code:before:content-[&#x27;&#x27;] prose-code:after:content-[&#x27;&#x27;] prose-p:text-white prose-a:text-cyan hover:prose-a:text-white hover:prose-a:underline prose-a:no-underline"><p>Today, we are going to do some spelunking within the deep, dark place which is your browser history.
In order to obtain the data for this tutorial from Google Chrome, go to
<code>~/Library/Application Support/Google/Chrome/Default</code>
on a Mac/Linux computer or <code>%LocalAppData%\Google\Chrome\User Data\Default</code> on a Windows PC.
Run the following SQLite command to obtain a text file in reverse chronological order:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">Mac/Linux</button><button class="py-2 px-4 hover:bg-gray-800 min-w-[150px] rounded-md mr-4">Windows</button></div><pre name="Mac/Linux" content="sqlite3 History &quot;select datetime(last_visit_time/1000000-11644473600,&#x27;unixepoch&#x27;), url \
from urls order by last_visit_time desc&quot; &gt; ~/hist.txt" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-bash" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span>sqlite3 History </span><span style="color:#98c379">&quot;select datetime(last_visit_time/1000000-11644473600,&#x27;unixepoch&#x27;), url \
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span style="color:#98c379">from urls order by last_visit_time desc&quot;</span><span> &gt; ~/hist.txt</span></span></code></pre></section>
<p>Check your user folder. A file called <code>hist.txt</code> should be there. Move the file to a suitable place for this exercise.</p>
<p>(This process brought to you by the brilliant people on <a href="https://superuser.com/questions/602252/can-chrome-browser-history-be-exported-to-an-html-file">Stack Exchange</a>)</p>
<p>Import the needed libraries, <code>numpy</code> and <code>pandas</code>:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button></div><pre name="main.py" content="import pandas as pd
import numpy as np" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#c678dd">import</span><span> pandas </span><span style="color:#c678dd">as</span><span> pd
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span></span><span style="color:#c678dd">import</span><span> numpy </span><span style="color:#c678dd">as</span><span> np</span></span></code></pre></section>
<h2>Clean Up Data</h2>
<p>That data that we pulled is extremely messy. Here&#x27;s an example row:</p>
<pre><div style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:#282c34"><code class="language-wiki" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#98c379">2017</span><span>-</span><span style="color:#d19a66">11</span><span>-</span><span style="color:#d19a66">12</span><span> </span><span style="color:#d19a66">21</span><span>:</span><span style="color:#d19a66">10</span><span>:</span><span style="color:#d19a66">11</span><span>|https://news.ycombinator.com/item?id=</span><span style="color:#d19a66">15678587</span></span></code></div></pre>
<p>We need to split on that vertical bar while making sure not to split on a bar in the URL itself.
Since Pandas probably doesn&#x27;t do this out of the box, let&#x27;s write a custom import function:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button><button class="py-2 px-4 hover:bg-gray-800 min-w-[150px] rounded-md mr-4">Result</button></div><pre name="main.py" content="# ...continued from previous code block...
# Open our file
with open(&#x27;hist.txt&#x27;) as f:
    content = f.readlines()
# Strip whitespace then split on first occurrence of pipe character
raw_data = [line.split(&#x27;|&#x27;, 1) for line in [x.strip() for x in content]]
# We now have a 2D list.
print(raw_data[1])" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># ...continued from previous code block...</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span></span><span style="color:#5c6370;font-style:italic"># Open our file</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span></span><span style="color:#c678dd">with</span><span> </span><span style="color:#e6c07b">open</span><span>(</span><span style="color:#98c379">&#x27;hist.txt&#x27;</span><span>) </span><span style="color:#c678dd">as</span><span> f:
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>    content = f.readlines()
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span></span><span style="color:#5c6370;font-style:italic"># Strip whitespace then split on first occurrence of pipe character</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span>raw_data = [line.split(</span><span style="color:#98c379">&#x27;|&#x27;</span><span>, </span><span style="color:#d19a66">1</span><span>) </span><span style="color:#c678dd">for</span><span> line </span><span style="color:#c678dd">in</span><span> [x.strip() </span><span style="color:#c678dd">for</span><span> x </span><span style="color:#c678dd">in</span><span> content]]
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span></span><span style="color:#5c6370;font-style:italic"># We now have a 2D list.</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span></span><span style="color:#e6c07b">print</span><span>(raw_data[</span><span style="color:#d19a66">1</span><span>])</span></span></code></pre></section>
<p>Using our 2D list, let&#x27;s make a Pandas DataFrame with custom column headers and make sure it is working:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button></div><pre name="main.py" content="# ...continued from previous code block...
data = pd.DataFrame(raw_data, columns=[&#x27;datetime&#x27;, &#x27;url&#x27;])
data.head(1)" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># ...continued from previous code block...</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span><span>data = pd.DataFrame(raw_data, columns=[</span><span style="color:#98c379">&#x27;datetime&#x27;</span><span>, </span><span style="color:#98c379">&#x27;url&#x27;</span><span>])
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>data.head(</span><span style="color:#d19a66">1</span><span>)</span></span></code></pre></section>
<table><thead><tr><th> </th><th>datetime</th><th>url</th></tr></thead><tbody><tr><td>0</td><td>2017-11-12 21:10:11</td><td><a href="https://news.ycombinator.com/item?id=15678587">https://news.ycombinator.com/item?id=15678587</a></td></tr></tbody></table>
<p>Now, we&#x27;re almost done with ingesting the data. Let&#x27;s convert the datetime string column into a
column of Pandas <code>datetime</code> elements and double-check that it is indeed a Pandas timestamp:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button></div><pre name="main.py" content="# ...continued from previous code block...
data.datetime = pd.to_datetime(data.datetime)
data.datetime[0]" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># ...continued from previous code block...</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">2</span>data.datetime = pd.to_datetime(data.datetime)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:1.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>data.datetime[</span><span style="color:#d19a66">0</span><span>]</span></span></code></pre></section>
<p>Finally, let&#x27;s remove all information from the URL, leaving only the domain/subdomain and check our work again:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button></div><pre name="main.py" content="# ...continued from previous code block...
from urllib.parse import urlparse
parser = lambda u: urlparse(u).netloc
data.url = data.url.apply(parser)
data.head(1)" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># ...continued from previous code block...</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span></span><span style="color:#c678dd">from</span><span> urllib.parse </span><span style="color:#c678dd">import</span><span> urlparse
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>parser = </span><span style="color:#c678dd">lambda</span><span> u: urlparse(u).netloc
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span>data.url = data.url.apply(parser)
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>data.head(</span><span style="color:#d19a66">1</span><span>)</span></span></code></pre></section>
<table><thead><tr><th> </th><th>datetime</th><th>url</th></tr></thead><tbody><tr><td>0</td><td>2017-11-12 21:10:11</td><td>news.ycombinator.com</td></tr></tbody></table>
<p>Finally, our data is clean.</p>
<h2>Analyzing the Data</h2>
<p>Now that the boring part is done, let&#x27;s analyze our browsing data.</p>
<h3>Most Visited Sites</h3>
<p>Let&#x27;s generate a list of our top sites sorted by frequency, then print out the first two to get our most visited sites:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button></div><pre name="main.py" content="# ...continued from previous code block...
# Aggregate domain entries
site_frequencies = data.url.value_counts().to_frame()
# Make the domain a column
site_frequencies.reset_index(level=0, inplace=True)
# Rename columns to appropriate names
site_frequencies.columns = [&#x27;domain&#x27;, &#x27;count&#x27;]
# Display top 2
site_frequencies.head(2)" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># ...continued from previous code block...</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span></span><span style="color:#5c6370;font-style:italic"># Aggregate domain entries</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span>site_frequencies = data.url.value_counts().to_frame()
</span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span></span><span style="color:#5c6370;font-style:italic"># Make the domain a column</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>site_frequencies.reset_index(level=</span><span style="color:#d19a66">0</span><span>, inplace=</span><span style="color:#56b6c2">True</span><span>)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span></span><span style="color:#5c6370;font-style:italic"># Rename columns to appropriate names</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span>site_frequencies.columns = [</span><span style="color:#98c379">&#x27;domain&#x27;</span><span>, </span><span style="color:#98c379">&#x27;count&#x27;</span><span>]
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span></span><span style="color:#5c6370;font-style:italic"># Display top 2</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span>site_frequencies.head(</span><span style="color:#d19a66">2</span><span>)</span></span></code></pre></section>
<table><thead><tr><th> </th><th>domain</th><th>count</th></tr></thead><tbody><tr><td>0</td><td><a href="http://www.google.com">www.google.com</a></td><td>3904</td></tr><tr><td>1</td><td>github.com</td><td>1571</td></tr></tbody></table>
<p>It should come as no shock that my top sites, just like any other dev, were Google and Github.</p>
<p><em>(Is secretly surprised that Stack Overflow was not one of the top ten)</em></p>
<p>Now, let&#x27;s see our top sites in a beautiful chart:</p>
<section class="w-full p-2 bg-gray-700 rounded-md"><div class="flex flex-row mb-2"><button class="py-2 px-4 bg-gray-900 min-w-[150px] rounded-md mr-4">main.py</button></div><pre name="main.py" content="# ...continued from previous code block...
import matplotlib.pyplot as plt
topN = 20
plt.figure(1, figsize=(10,10))
plt.title(&#x27;Top $n Sites Visited&#x27;.replace(&#x27;$n&#x27;, str(topN)))
pie_data = site_frequencies[&#x27;count&#x27;].head(topN).tolist()
pie_labels = None
# Uncomment to get specific domain names
# pie_labels = site_frequencies[&#x27;domain&#x27;].head(topN).tolist()
plt.pie(pie_data, autopct=&#x27;%1.1f%%&#x27;, labels=pie_labels)
plt.show()" style="display:block;overflow-x:auto;padding:1rem;color:#abb2bf;background:#282c34;margin:0;border-radius:0.375rem"><code class="language-python" style="white-space:pre"><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">1</span><span style="color:#5c6370;font-style:italic"># ...continued from previous code block...</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">2</span><span></span><span style="color:#c678dd">import</span><span> matplotlib.pyplot </span><span style="color:#c678dd">as</span><span> plt
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">3</span><span>topN = </span><span style="color:#d19a66">20</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">4</span><span>plt.figure(</span><span style="color:#d19a66">1</span><span>, figsize=(</span><span style="color:#d19a66">10</span><span>,</span><span style="color:#d19a66">10</span><span>))
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">5</span><span>plt.title(</span><span style="color:#98c379">&#x27;Top $n Sites Visited&#x27;</span><span>.replace(</span><span style="color:#98c379">&#x27;$n&#x27;</span><span>, </span><span style="color:#e6c07b">str</span><span>(topN)))
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">6</span><span>pie_data = site_frequencies[</span><span style="color:#98c379">&#x27;count&#x27;</span><span>].head(topN).tolist()
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">7</span><span>pie_labels = </span><span style="color:#56b6c2">None</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">8</span><span></span><span style="color:#5c6370;font-style:italic"># Uncomment to get specific domain names</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">9</span><span></span><span style="color:#5c6370;font-style:italic"># pie_labels = site_frequencies[&#x27;domain&#x27;].head(topN).tolist()</span><span>
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">10</span><span>plt.pie(pie_data, autopct=</span><span style="color:#98c379">&#x27;%1.1f%%&#x27;</span><span>, labels=pie_labels)
</span></span><span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:2.25em;padding-right:1em;text-align:right;user-select:none">11</span>plt.show()</span></code></pre></section>
<img alt="browser history graph" src="/post-images/browser-hist-graph.jpg" width="500" height="500" decoding="async" data-nimg="1" class="mx-auto" loading="lazy" style="color:transparent"/>
<p>What else can we do with the data? A lot, I&#x27;m sure, since this is the Holy Grail for ad tracking
companies.</p></main></article></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    code: \"code\",\n    a: \"a\",\n    h2: \"h2\",\n    pre: \"pre\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    h3: \"h3\",\n    em: \"em\"\n  }, _provideComponents(), props.components), {MultiCode, Image} = _components;\n  if (!Image) _missingMdxReference(\"Image\", true);\n  if (!MultiCode) _missingMdxReference(\"MultiCode\", true);\n  return _jsxs(_Fragment, {\n    children: [_jsxs(_components.p, {\n      children: [\"Today, we are going to do some spelunking within the deep, dark place which is your browser history.\\nIn order to obtain the data for this tutorial from Google Chrome, go to\\n\", _jsx(_components.code, {\n        children: \"~/Library/Application Support/Google/Chrome/Default\"\n      }), \"\\non a Mac/Linux computer or \", _jsx(_components.code, {\n        children: \"%LocalAppData%\\\\Google\\\\Chrome\\\\User Data\\\\Default\"\n      }), \" on a Windows PC.\\nRun the following SQLite command to obtain a text file in reverse chronological order:\"]\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"Mac/Linux\",\n        content: `sqlite3 History \"select datetime(last_visit_time/1000000-11644473600,'unixepoch'), url \\\\\nfrom urls order by last_visit_time desc\" \u003e ~/hist.txt`,\n        language: \"bash\"\n      }, {\n        name: \"Windows\",\n        content: `sqlite3 History \"select datetime(last_visit_time/1000000-11644473600,'unixepoch'), url \\\\\nfrom urls order by last_visit_time desc\" \u003e %userprofile%\\hist.txt`,\n        language: \"bash\"\n      }]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Check your user folder. A file called \", _jsx(_components.code, {\n        children: \"hist.txt\"\n      }), \" should be there. Move the file to a suitable place for this exercise.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"(This process brought to you by the brilliant people on \", _jsx(_components.a, {\n        href: \"https://superuser.com/questions/602252/can-chrome-browser-history-be-exported-to-an-html-file\",\n        children: \"Stack Exchange\"\n      }), \")\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Import the needed libraries, \", _jsx(_components.code, {\n        children: \"numpy\"\n      }), \" and \", _jsx(_components.code, {\n        children: \"pandas\"\n      }), \":\"]\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `import pandas as pd\nimport numpy as np`\n      }]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Clean Up Data\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"That data that we pulled is extremely messy. Here's an example row:\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-wiki\",\n        children: \"2017-11-12 21:10:11|https://news.ycombinator.com/item?id=15678587\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"We need to split on that vertical bar while making sure not to split on a bar in the URL itself.\\nSince Pandas probably doesn't do this out of the box, let's write a custom import function:\"\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `# ...continued from previous code block...\n# Open our file\nwith open('hist.txt') as f:\n    content = f.readlines()\n# Strip whitespace then split on first occurrence of pipe character\nraw_data = [line.split('|', 1) for line in [x.strip() for x in content]]\n# We now have a 2D list.\nprint(raw_data[1])`,\n        language: \"python\"\n      }, {\n        name: \"Result\",\n        content: `['2017-11-12 21:09:21', 'https://news.ycombinator.com/']`,\n        language: \"wiki\"\n      }]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Using our 2D list, let's make a Pandas DataFrame with custom column headers and make sure it is working:\"\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `# ...continued from previous code block...\ndata = pd.DataFrame(raw_data, columns=['datetime', 'url'])\ndata.head(1)`,\n        language: \"python\"\n      }]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \" \"\n          }), _jsx(_components.th, {\n            children: \"datetime\"\n          }), _jsx(_components.th, {\n            children: \"url\"\n          })]\n        })\n      }), _jsx(_components.tbody, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"2017-11-12 21:10:11\"\n          }), _jsx(_components.td, {\n            children: _jsx(_components.a, {\n              href: \"https://news.ycombinator.com/item?id=15678587\",\n              children: \"https://news.ycombinator.com/item?id=15678587\"\n            })\n          })]\n        })\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"Now, we're almost done with ingesting the data. Let's convert the datetime string column into a\\ncolumn of Pandas \", _jsx(_components.code, {\n        children: \"datetime\"\n      }), \" elements and double-check that it is indeed a Pandas timestamp:\"]\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `# ...continued from previous code block...\ndata.datetime = pd.to_datetime(data.datetime)\ndata.datetime[0]`,\n        language: \"python\"\n      }]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Finally, let's remove all information from the URL, leaving only the domain/subdomain and check our work again:\"\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `# ...continued from previous code block...\nfrom urllib.parse import urlparse\nparser = lambda u: urlparse(u).netloc\ndata.url = data.url.apply(parser)\ndata.head(1)`,\n        language: \"python\"\n      }]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \" \"\n          }), _jsx(_components.th, {\n            children: \"datetime\"\n          }), _jsx(_components.th, {\n            children: \"url\"\n          })]\n        })\n      }), _jsx(_components.tbody, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"2017-11-12 21:10:11\"\n          }), _jsx(_components.td, {\n            children: \"news.ycombinator.com\"\n          })]\n        })\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Finally, our data is clean.\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Analyzing the Data\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now that the boring part is done, let's analyze our browsing data.\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Most Visited Sites\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Let's generate a list of our top sites sorted by frequency, then print out the first two to get our most visited sites:\"\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `# ...continued from previous code block...\n# Aggregate domain entries\nsite_frequencies = data.url.value_counts().to_frame()\n# Make the domain a column\nsite_frequencies.reset_index(level=0, inplace=True)\n# Rename columns to appropriate names\nsite_frequencies.columns = ['domain', 'count']\n# Display top 2\nsite_frequencies.head(2)`,\n        language: \"python\"\n      }]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \" \"\n          }), _jsx(_components.th, {\n            children: \"domain\"\n          }), _jsx(_components.th, {\n            children: \"count\"\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: _jsx(_components.a, {\n              href: \"http://www.google.com\",\n              children: \"www.google.com\"\n            })\n          }), _jsx(_components.td, {\n            children: \"3904\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"github.com\"\n          }), _jsx(_components.td, {\n            children: \"1571\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"It should come as no shock that my top sites, just like any other dev, were Google and Github.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.em, {\n        children: \"(Is secretly surprised that Stack Overflow was not one of the top ten)\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Now, let's see our top sites in a beautiful chart:\"\n    }), \"\\n\", _jsx(MultiCode, {\n      tabs: [{\n        name: \"main.py\",\n        content: `# ...continued from previous code block...\nimport matplotlib.pyplot as plt\ntopN = 20\nplt.figure(1, figsize=(10,10))\nplt.title('Top $n Sites Visited'.replace('$n', str(topN)))\npie_data = site_frequencies['count'].head(topN).tolist()\npie_labels = None\n# Uncomment to get specific domain names\n# pie_labels = site_frequencies['domain'].head(topN).tolist()\nplt.pie(pie_data, autopct='%1.1f%%', labels=pie_labels)\nplt.show()`,\n        language: \"python\"\n      }]\n    }), \"\\n\", _jsx(Image, {\n      src: \"/post-images/browser-hist-graph.jpg\",\n      width: 500,\n      height: 500,\n      className: \"mx-auto\",\n      alt: \"browser history graph\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"What else can we do with the data? A lot, I'm sure, since this is the Holy Grail for ad tracking\\ncompanies.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{"title":"Analyzing Browser History Using Python and Pandas","description":"Explore the depths of your browser history with this introductory data science tutorial.","date":1510516800000,"displayDate":"November 12, 2017","tags":["Legacy Content"]}},"frontMatter":{"title":"Analyzing Browser History Using Python and Pandas","description":"Explore the depths of your browser history with this introductory data science tutorial.","date":1510516800000,"displayDate":"November 12, 2017","tags":["Legacy Content"]}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"analyzing-browser-hist-using-python"},"buildId":"aSyoPV7O50QT6mPbepoKW","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>