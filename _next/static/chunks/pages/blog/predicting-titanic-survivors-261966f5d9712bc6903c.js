(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{7375:function(a,e,t){"use strict";function n(a,e){if(null==a)return{};var t,n,s=function(a,e){if(null==a)return{};var t,n,s={},m=Object.keys(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||(s[t]=a[t]);return s}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}t.d(e,{Z:function(){return n}})},9622:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return k},frontMatter:function(){return c}});var n=t(6156),s=t(7375),m=(t(7294),t(3905)),p=t(5893),r=function(a){return(0,p.jsx)("iframe",{src:a.url,width:"600px",height:"300px",style:{border:"1px solid #ccc"},frameBorder:"0"})};function o(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function N(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){(0,n.Z)(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}var c={title:"Predicting Titanic Survivors: My First Machine Learning Model",description:"Learn how to build a machine learning model to predict Titanic survivors based on the Kaggle dataset.",date:"August 4, 2018",draft:!1,hasMath:!0,pubTime:"2018-08-04T23:00:00Z"},l={frontMatter:c};function k(a){var e=a.components,t=(0,s.Z)(a,["components"]);return(0,m.kt)("wrapper",N(N(N({},l),t),{},{components:e,mdxType:"MDXLayout"}),(0,m.kt)("p",null,"I've been taking the ",(0,m.kt)("a",N({parentName:"p"},{href:"https://www.coursera.org/learn/machine-learning"}),"Machine Learning course by Dr. Andrew Ng")," online through Coursera, and so far it's been an enlightening and enjoyable experience. While I've been taking lots of notes on the equations and implementation details on linear and logistic regression models, I thought it would be a fun weekend exercise to implement these algorithms from scratch using my favorite toolkit: Python, Pandas, and Numpy."),(0,m.kt)("p",null,"Special thanks to Dr. Ng and his course staff for preparing such high-quality course material. Many of these equations and explanations are based on notes from the course lectures, and I have paraphrased many of the explanations here in my own words as best as possible."),(0,m.kt)("h2",null,"The Dataset"),(0,m.kt)("p",null,"The dataset I decided to work with for this project was the was the ",(0,m.kt)("a",N({parentName:"p"},{href:"https://www.kaggle.com/c/titanic"}),"Kaggle Titanic dataset"),", which was recommended as a beginner dataset to work with."),(0,m.kt)("p",null,(0,m.kt)("img",N({parentName:"p"},{src:"/static/img/titanic-training.png",alt:"Titanic Dataset Data"})),"\n",(0,m.kt)("em",{parentName:"p"},(0,m.kt)("strong",{parentName:"em"},"Figure 1:")," Structure of the dataset")),(0,m.kt)("p",null,"Based on the ",(0,m.kt)("inlineCode",{parentName:"p"},"train.csv")," file included in the dataset download, it was clear that this was a binary classification problem. Since I only know how to implement linear and logistic regression models so far, I decided to use logistic regression for this problem."),(0,m.kt)("h2",null,"Project Structure"),(0,m.kt)("p",null,"For reference, my project directory was structured like this:"),(0,m.kt)("pre",N({},{className:"language-wiki"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-wiki"}),".\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 data\n\u2502   \u251c\u2500\u2500 gender_submission.csv\n\u2502   \u251c\u2500\u2500 test.csv\n\u2502   \u2514\u2500\u2500 train.csv\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 Titanic.ipynb\n")),(0,m.kt)("p",null,"The ",(0,m.kt)("inlineCode",{parentName:"p"},"Makefile")," in the main directory has a fake target to make launching ",(0,m.kt)("inlineCode",{parentName:"p"},"jupyter lab")," easier."),(0,m.kt)("h2",null,"Preparing the Data"),(0,m.kt)("p",null,"I first needed to clean the data before I could use it. In order to do that, I first brought the data into a pandas ",(0,m.kt)("inlineCode",{parentName:"p"},"DataFrame"),":"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"import")," pandas ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"as")," pd\ndf ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," pd",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"read_csv",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"../data/train.csv"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"Then, I dropped the columns that I couldn't convert into numbers:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"df ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"drop",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"columns",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"="),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Name'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'PassengerId'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Ticket'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Cabin'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,(0,m.kt)("strong",{parentName:"p"},"Note:")," Having fewer features means the model was less accurate than it could be. Some clever feature engineering would have made use of these columns somehow, but as I was a beginner, I didn't really know what to do with these features other than throw them out."),(0,m.kt)("p",null,"Next, I converted all of the textual features into numerical values roughly within the range ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mo",N({parentName:"mrow"},{separator:"true"}),","),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"(-1, 1)")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1"),(0,m.kt)("span",N({parentName:"span"},{className:"mpunct"}),","),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"))))),"."),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"sex_to_numerical"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"s",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"int"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"g ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"==")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"female"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"embarkation_to_numerical"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"e",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"if")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"e ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"==")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"C"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n        ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-"),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"elif")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"e ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"==")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"Q"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n        ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"else"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n        ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),"\ndf",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Sex ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Sex",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"sex_to_numerical",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ndf",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Embarked ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Embarked",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"embarkation_to_numerical",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"I then normalized the data using a simple approach: ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"v"),(0,m.kt)("mi",{parentName:"mrow"},"a"),(0,m.kt)("mi",{parentName:"mrow"},"l"),(0,m.kt)("mi",{parentName:"mrow"},"u"),(0,m.kt)("mi",{parentName:"mrow"},"e"),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mi",{parentName:"mrow"},"m"),(0,m.kt)("mi",{parentName:"mrow"},"a"),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mi",N({parentName:"mrow"},{mathvariant:"normal"}),"/"),(0,m.kt)("mi",{parentName:"mrow"},"r"),(0,m.kt)("mi",{parentName:"mrow"},"a"),(0,m.kt)("mi",{parentName:"mrow"},"n"),(0,m.kt)("mi",{parentName:"mrow"},"g"),(0,m.kt)("mi",{parentName:"mrow"},"e")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"(value - max)/range")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"v"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"a"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.01968em"}}),"l"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"u"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"e"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"ma"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"/"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"r"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"an"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"g"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"e"))))),", where ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"r"),(0,m.kt)("mi",{parentName:"mrow"},"a"),(0,m.kt)("mi",{parentName:"mrow"},"n"),(0,m.kt)("mi",{parentName:"mrow"},"g"),(0,m.kt)("mi",{parentName:"mrow"},"e"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mi",{parentName:"mrow"},"m"),(0,m.kt)("mi",{parentName:"mrow"},"a"),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mi",{parentName:"mrow"},"m"),(0,m.kt)("mi",{parentName:"mrow"},"i"),(0,m.kt)("mi",{parentName:"mrow"},"n")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"range = max - min")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"r"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"an"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"g"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"e"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.66666em",verticalAlign:"-0.08333em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"ma"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.65952em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"min"))))),"."),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"normalize_ticket_class"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"cl",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"cl ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"3"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"/")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"2"),"\n",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"normalize_fare"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"farecol",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    range_f ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," farecol",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"max"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," farecol",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"min"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    max_f ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," farecol",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"max"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," farecol",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"lambda")," fare",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"fare ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," max_f",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"/"),"range_f",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ndf",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Fare ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," normalize_fare",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Fare",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ndf",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Pclass ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Pclass",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"normalize_ticket_class",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"I needed to convert all missing/",(0,m.kt)("inlineCode",{parentName:"p"},"NaN")," values in the ",(0,m.kt)("inlineCode",{parentName:"p"},"Age")," column to numbers so that I didn't need to throw that feature out:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"de_nan_age"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"a",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"if")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"isnan",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"a",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n        ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0.0"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"else"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n        ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," a\ndf",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Age ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Age",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"de_nan_age",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"After all this processing, the ",(0,m.kt)("inlineCode",{parentName:"p"},"DataFrame")," looks like this:"),(0,m.kt)("table",null,(0,m.kt)("thead",{parentName:"table"},(0,m.kt)("tr",{parentName:"thead"},(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Index"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Survived"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Pclass"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Sex"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Age"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"SibSp"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Parch"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Fare"),(0,m.kt)("th",N({parentName:"tr"},{align:null}),"Embarked"))),(0,m.kt)("tbody",{parentName:"table"},(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"22.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-0.985848942437792"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1")),(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-1.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"38.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-0.8608642646173593"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-1")),(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",N({parentName:"tr"},{align:null}),"2"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"26.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-0.9845314301820002"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1")),(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",N({parentName:"tr"},{align:null}),"3"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-1.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"35.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-0.8963557025443796"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1")),(0,m.kt)("tr",{parentName:"tbody"},(0,m.kt)("td",N({parentName:"tr"},{align:null}),"4"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"35.0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"0"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"-0.9842874464309276"),(0,m.kt)("td",N({parentName:"tr"},{align:null}),"1")))),(0,m.kt)("p",null,"Now, I'll split up the ",(0,m.kt)("inlineCode",{parentName:"p"},"DataFrame")," into two ",(0,m.kt)("inlineCode",{parentName:"p"},"np.array"),"s, one with the features, the other with the labels:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"features ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"drop",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"columns",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"="),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Survived'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"values\nlabels ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Survived",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"values\n")),(0,m.kt)("p",null,"Add an ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("msub",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msub"},"x"),(0,m.kt)("mn",{parentName:"msub"},"0")),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mn",{parentName:"mrow"},"1")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"x_0 = 1")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),"0")))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),(0,m.kt)("span",{parentName:"span"})))))),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.64444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1")))))," column to the features array so everything looks clean:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"x_zero_column ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"zeros",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"features",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"shape",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"+")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),"\nfeatures ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"append",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"x_zero_column",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," features",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," axis",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"="),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"Using the features and labels arrays, create a ",(0,m.kt)("em",{parentName:"p"},"design matrix")," ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"X")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.07847em"}}),"X")))))," and the ",(0,m.kt)("em",{parentName:"p"},"label vector")," ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"y")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"y")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"))))),":"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"X ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"asmatrix",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"features",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n",(0,m.kt)("span",N({parentName:"code"},{className:"token comment"}),"# y needs to be transposed from a row vector to a column vector"),"\ny ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"asmatrix",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"labels",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"T\n")),(0,m.kt)("p",null,"The data is now ready to be used."),(0,m.kt)("h2",null,"Define Variables"),(0,m.kt)("p",null,"Using ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"X")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.07847em"}}),"X")))))," and ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"y")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"y")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"))))),", it's time to define some variables that are important to the implmentation of the ",(0,m.kt)("em",{parentName:"p"},"cost function")," ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"J")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"J")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.09618em"}}),"J"))))),":"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token comment"}),"# m is the number of training samples"),"\nm ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"shape",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),"\n",(0,m.kt)("span",N({parentName:"code"},{className:"token comment"}),"# n is the number of features, in this case we are not counting the x_0 column"),"\nn ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"shape",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),"\n")),(0,m.kt)("p",null,"Let's define the parameter ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8")))))," as a ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"n"),(0,m.kt)("mo",{parentName:"mrow"},"+"),(0,m.kt)("mn",{parentName:"mrow"},"1")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"n+1")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.66666em",verticalAlign:"-0.08333em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"n"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"+"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.64444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1"))))),"-dimensional vector, initially filled with zeros:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"theta ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"asmatrix",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"zeros",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"n ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"+")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"T\n")),(0,m.kt)("p",null,"And let's set a learning rate ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b1")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\alpha")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.0037em"}}),"\u03b1"))))),", in this case I just chose an arbitrary value:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"alpha ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0.001"),"\n")),(0,m.kt)("p",null,"It's important to choose the right ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b1")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\alpha")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.0037em"}}),"\u03b1"))))),", because a smaller value may make the model slower to converge, while a larger value might make the model never converge."),(0,m.kt)("h2",null,"Define Functions"),(0,m.kt)("h3",null,"The Sigmoid Function"),(0,m.kt)("p",null,"One of the most important equations needed for logistic regression is the sigmoid function, which looks like this:"),(0,m.kt)("center",null,(0,m.kt)(r,{url:"https://www.desmos.com/calculator/hvlhutwrba?embed",mdxType:"Desmos"})),(0,m.kt)("p",null,"The equation for the sigmoid function is ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"g"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"z"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mfrac",{parentName:"mrow"},(0,m.kt)("mn",{parentName:"mfrac"},"1"),(0,m.kt)("mrow",{parentName:"mfrac"},(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mo",{parentName:"mrow"},"+"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msup"},"e"),(0,m.kt)("mrow",{parentName:"msup"},(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mi",{parentName:"mrow"},"z")))))),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"g(z) = \\frac{1}{1+ e^{-z}}")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"g"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.04398em"}}),"z"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1.2484389999999999em",verticalAlign:"-0.403331em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mopen nulldelimiter"})),(0,m.kt)("span",N({parentName:"span"},{className:"mfrac"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.845108em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.655em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),"1"),(0,m.kt)("span",N({parentName:"span"},{className:"mbin mtight"}),"+"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight"}),"e"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.7026642857142857em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.786em",marginRight:"0.07142857142857144em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.5em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size3 size1 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"}}),"z")))))))))))),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.23em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"frac-line",style:{borderBottomWidth:"0.04em"}}))),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.394em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),"1"))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.403331em"}}),(0,m.kt)("span",{parentName:"span"}))))),(0,m.kt)("span",N({parentName:"span"},{className:"mclose nulldelimiter"})))))))),(0,m.kt)("p",null,"Thanks to numpy, it's very simple to define an element-wise vectorized sigmoid function, which will our code much more efficient:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"sigmoid"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"z",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    t ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"exp",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-"),"z",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"+")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"divide",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," t",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("h3",null,"The Hypothesis Function"),(0,m.kt)("p",null,"To generate a matrix of predictions using the parameter vector ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"))))),", we define our hypothesis function ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("msub",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msub"},"h"),(0,m.kt)("mi",{parentName:"msub"},"\u03b8")),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"h_{\\theta}(x)")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"h"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.33610799999999996em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}}),"\u03b8"))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),(0,m.kt)("span",{parentName:"span"})))))),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")")))))," as follows:"),(0,m.kt)("p",null,(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("msub",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msub"},"h"),(0,m.kt)("mi",{parentName:"msub"},"\u03b8")),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mi",{parentName:"mrow"},"g"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"X"),(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"h_{\\theta}(x) = g(X\\theta)")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"h"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.33610799999999996em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}}),"\u03b8"))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),(0,m.kt)("span",{parentName:"span"})))))),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"g"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"X\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")")))))),(0,m.kt)("p",null,"where ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"X")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"X")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.07847em"}}),"X")))))," is the design matrix."),(0,m.kt)("p",null,"But what does the output of this function mean? ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("msub",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msub"},"h"),(0,m.kt)("mi",{parentName:"msub"},"\u03b8")),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"h_{\\theta}(x)")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"h"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.33610799999999996em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}}),"\u03b8"))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),(0,m.kt)("span",{parentName:"span"})))))),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")")))))," is actually outputting the ",(0,m.kt)("em",{parentName:"p"},"probability")," that the output is 1. Formally, this function gives you the probablility that ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"y"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mn",{parentName:"mrow"},"1")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"y=1")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.625em",verticalAlign:"-0.19444em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.64444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1"))))),", given ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"x")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"x")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.43056em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"))))),", parameterized by ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8")))))," (mathematically, ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"y"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mi",N({parentName:"mrow"},{mathvariant:"normal"}),"\u2223"),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{separator:"true"}),";"),(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"P(y=1|x;\\theta)")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.13889em"}}),"P"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1\u2223"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mpunct"}),";"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"))))),"."),(0,m.kt)("p",null,"In Python, we can define the hypothesis function similarly:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"hypothesis"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"x",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," sigmoid",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"x ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"*")," theta",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("h3",null,"The Cost Function"),(0,m.kt)("p",null,"In order for the logistic regression algorithm to ",(0,m.kt)("em",{parentName:"p"},"learn"),", it must have some function to minimize. This function is called the ",(0,m.kt)("em",{parentName:"p"},"cost")," or ",(0,m.kt)("em",{parentName:"p"},"loss")," function."),(0,m.kt)("p",null,"For logistic regression, the cost function is defined as:"),(0,m.kt)("p",null,(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"J"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mfrac",{parentName:"mrow"},(0,m.kt)("mn",{parentName:"mfrac"},"1"),(0,m.kt)("mi",{parentName:"mfrac"},"m")),(0,m.kt)("mo",N({parentName:"mrow"},{fence:"false",stretchy:"true",minsize:"2.4em",maxsize:"2.4em"}),"("),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msup"},"y"),(0,m.kt)("mi",{parentName:"msup"},"T")),(0,m.kt)("mi",{parentName:"mrow"},"log"),(0,m.kt)("mo",{parentName:"mrow"},"\u2061"),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mrow"},"h"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msup"},"y"),(0,m.kt)("mi",{parentName:"msup"},"T")),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mi",{parentName:"mrow"},"log"),(0,m.kt)("mo",{parentName:"mrow"},"\u2061"),(0,m.kt)("mrow",{parentName:"mrow"},(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mi",{parentName:"mrow"},"h"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("mo",N({parentName:"mrow"},{fence:"false",stretchy:"true",minsize:"2.4em",maxsize:"2.4em"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"J(\\theta) = \\frac{1}{m} \\bigg(-y^T \\log{h(x)}- (1-y^T)\\log{(1-h(x))}\\bigg)")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.09618em"}}),"J"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"2.40003em",verticalAlign:"-0.95003em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mopen nulldelimiter"})),(0,m.kt)("span",N({parentName:"span"},{className:"mfrac"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.845108em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.6550000000000002em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight"}),"m")))),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.23em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"frac-line",style:{borderBottomWidth:"0.04em"}}))),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.394em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),"1"))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.345em"}}),(0,m.kt)("span",{parentName:"span"}))))),(0,m.kt)("span",N({parentName:"span"},{className:"mclose nulldelimiter"}))),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"delimsizing size3"}),"(")),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1.0913309999999998em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.8413309999999999em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.063em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}}),"T")))))))),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mop"}),"lo",(0,m.kt)("span",N({parentName:"span"},{style:{marginRight:"0.01389em"}}),"g")),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"h"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")")),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"2.40003em",verticalAlign:"-0.95003em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.8413309999999999em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.063em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}}),"T")))))))),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mop"}),"lo",(0,m.kt)("span",N({parentName:"span"},{style:{marginRight:"0.01389em"}}),"g")),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"h"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),"))")),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"delimsizing size3"}),")"))))))),(0,m.kt)("p",null,"The Python code for this function came out to be too long to write out on one line, so the math is done on three separate lines."),(0,m.kt)("p",null,(0,m.kt)("strong",{parentName:"p"},"Note:")," ",(0,m.kt)("inlineCode",{parentName:"p"},"cost")," came out to be a 1x1 numpy matrix and was converted into a singular floating-point value at the end."),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"cost"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    hypo ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," hypothesis",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    part1 ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"y",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"T",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"*")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"log",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"hypo",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    part2 ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"y",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"T",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"*")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"log",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," hypo",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    cost ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"/"),"m",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"*")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"part1 ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," part2",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," cost",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),","),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),"\n")),(0,m.kt)("h3",null,"The Gradient Descent Function"),(0,m.kt)("p",null,"The last (and probably most important) piece of this machine learning algorithm is the ",(0,m.kt)("inlineCode",{parentName:"p"},"gradient_descent_step")," function, which calculates the gradient for ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"))))),"."),(0,m.kt)("p",null,"The update rule for ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8")))))," is as follows:"),(0,m.kt)("p",null,(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",{parentName:"mrow"},":"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mfrac",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"mfrac"},"\u03b1"),(0,m.kt)("mi",{parentName:"mfrac"},"m")),(0,m.kt)("msup",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msup"},"X"),(0,m.kt)("mi",{parentName:"msup"},"T")),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"g"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"X"),(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mo",{parentName:"mrow"},"\u2212"),(0,m.kt)("mover",N({parentName:"mrow"},{accent:"true"}),(0,m.kt)("mi",{parentName:"mover"},"y"),(0,m.kt)("mo",{parentName:"mover"},"\u20d7")),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta := \\theta - \\frac{\\alpha}{m}X^T(g(X\\theta)-\\vec{y})")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),":="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.77777em",verticalAlign:"-0.08333em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1.186331em",verticalAlign:"-0.345em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mopen nulldelimiter"})),(0,m.kt)("span",N({parentName:"span"},{className:"mfrac"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.695392em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.6550000000000002em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight"}),"m")))),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.23em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"frac-line",style:{borderBottomWidth:"0.04em"}}))),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.394em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.0037em"}}),"\u03b1"))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.345em"}}),(0,m.kt)("span",{parentName:"span"}))))),(0,m.kt)("span",N({parentName:"span"},{className:"mclose nulldelimiter"}))),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.07847em"}}),"X"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.8413309999999999em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3.063em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}}),"T")))))))),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"g"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"X\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mbin"}),"\u2212"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2222222222222222em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord accent"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.714em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y")),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-3em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"3em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"accent-body",style:{left:"-0.17994em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"overlay",style:{height:"0.714em",width:"0.471em"}}),(0,m.kt)("svg",N({parentName:"span"},{width:"0.471em",height:"0.714em",style:{width:"0.471em"},viewBox:"0 0 471 714",preserveAspectRatio:"xMinYMin"}),(0,m.kt)("path",N({parentName:"svg"},{d:"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z"}))))))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.19444em"}}),(0,m.kt)("span",{parentName:"span"}))))),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")")))))),(0,m.kt)("p",null,"This is simple to implement in Python as a one-liner:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"gradient_descent_step"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"theta",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," theta ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"alpha",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"/"),"m",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"*"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"T",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"*"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"hypothesis",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"-")," y",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"With all the necessary functions implemented, it's time to actually learn the parameters ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"))))),"."),(0,m.kt)("h2",null,"Run the Learning Algorithm"),(0,m.kt)("p",null,"To run the learning algorithm, let's create a loop in which ",(0,m.kt)("inlineCode",{parentName:"p"},"gradient_descent_step")," is run every iteration:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"for")," i ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"in")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"range"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1630000"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    theta ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," gradient_descent_step",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"theta",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"I found experimentally that after 1.63 million iterations, the cost delta after each iteration of Gradient Descent is negligible."),(0,m.kt)("p",null,"After the loop was run, the cost was approximately ",(0,m.kt)("inlineCode",{parentName:"p"},"0.45085533814736584"),"."),(0,m.kt)("p",null,"Before we do anything else, let's save the optimal ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"\u03b8")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"\\theta")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.69444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8")))))," in a file:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"savetxt",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"theta.txt"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," theta",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"Once saved, it can be loaded back like this:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"theta ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"asmatrix",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"loadtxt",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"theta.txt"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntheta ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," theta",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"T\n")),(0,m.kt)("h2",null,"Run the Model on Test Data"),(0,m.kt)("h3",null,"Create the Prediction Function"),(0,m.kt)("p",null,"Using the ",(0,m.kt)("inlineCode",{parentName:"p"},"hypothesis(x)")," function, let's define a function that outputs ",(0,m.kt)("inlineCode",{parentName:"p"},"1")," if ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("mi",{parentName:"mrow"},"P"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),"("),(0,m.kt)("mi",{parentName:"mrow"},"y"),(0,m.kt)("mo",{parentName:"mrow"},"="),(0,m.kt)("mn",{parentName:"mrow"},"1"),(0,m.kt)("mi",N({parentName:"mrow"},{mathvariant:"normal"}),"\u2223"),(0,m.kt)("mi",{parentName:"mrow"},"x"),(0,m.kt)("mo",N({parentName:"mrow"},{separator:"true"}),";"),(0,m.kt)("mi",{parentName:"mrow"},"\u03b8"),(0,m.kt)("mo",N({parentName:"mrow"},{stretchy:"false"}),")"),(0,m.kt)("mo",{parentName:"mrow"},"\u2265"),(0,m.kt)("mn",{parentName:"mrow"},"0.5")),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"P(y=1|x;\\theta) \u2265 0.5")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.13889em"}}),"P"),(0,m.kt)("span",N({parentName:"span"},{className:"mopen"}),"("),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.03588em"}}),"y"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"="),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"1\u2223"),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"mpunct"}),";"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.16666666666666666em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal",style:{marginRight:"0.02778em"}}),"\u03b8"),(0,m.kt)("span",N({parentName:"span"},{className:"mclose"}),")"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mrel"}),"\u2265"),(0,m.kt)("span",N({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.64444em",verticalAlign:"0em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),"0.5")))))," or ",(0,m.kt)("inlineCode",{parentName:"p"},"0")," otherwise:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"def")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token function"}),"predict"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"x",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":"),"\n    h ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," hypothesis",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"x",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    comp ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"h ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),">=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0.5"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"return")," comp",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"astype",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"int"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,(0,m.kt)("inlineCode",{parentName:"p"},"predict(x)")," runs predictions on a matrix element-wise and converts them into numerical binary values."),(0,m.kt)("h3",null,"Import the Test Data"),(0,m.kt)("p",null,"Now, it's time to bring in the test data, preparing it like we did for the training data:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"test_df ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," pd",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"read_csv",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"../data/test.csv"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_df ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"drop",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"columns",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"="),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Name'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'PassengerId'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Ticket'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),"'Cabin'"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Pclass ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Pclass",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"normalize_ticket_class",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Sex ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Sex",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"sex_to_numerical",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Fare ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," normalize_fare",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Fare",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Embarked ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Embarked",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"embarkation_to_numerical",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Age ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Age",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),(0,m.kt)("span",N({parentName:"code"},{className:"token builtin"}),"apply"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"de_nan_age",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"Let's add in the ",(0,m.kt)("span",N({parentName:"p"},{className:"math math-inline"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex"}),(0,m.kt)("span",N({parentName:"span"},{className:"katex-mathml"}),(0,m.kt)("math",N({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),(0,m.kt)("semantics",{parentName:"math"},(0,m.kt)("mrow",{parentName:"semantics"},(0,m.kt)("msub",{parentName:"mrow"},(0,m.kt)("mi",{parentName:"msub"},"x"),(0,m.kt)("mn",{parentName:"msub"},"0"))),(0,m.kt)("annotation",N({parentName:"semantics"},{encoding:"application/x-tex"}),"x_0")))),(0,m.kt)("span",N({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),(0,m.kt)("span",N({parentName:"span"},{className:"base"}),(0,m.kt)("span",N({parentName:"span"},{className:"strut",style:{height:"0.58056em",verticalAlign:"-0.15em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"mord"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mathnormal"}),"x"),(0,m.kt)("span",N({parentName:"span"},{className:"msupsub"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-t vlist-t2"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.30110799999999993em"}}),(0,m.kt)("span",N({parentName:"span"},{style:{top:"-2.5500000000000003em",marginLeft:"0em",marginRight:"0.05em"}}),(0,m.kt)("span",N({parentName:"span"},{className:"pstrut",style:{height:"2.7em"}})),(0,m.kt)("span",N({parentName:"span"},{className:"sizing reset-size6 size3 mtight"}),(0,m.kt)("span",N({parentName:"span"},{className:"mord mtight"}),"0")))),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-s"}),"\u200b")),(0,m.kt)("span",N({parentName:"span"},{className:"vlist-r"}),(0,m.kt)("span",N({parentName:"span"},{className:"vlist",style:{height:"0.15em"}}),(0,m.kt)("span",{parentName:"span"}))))))))))," column like before:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"test_X ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"values\nx_zero_column_test ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"zeros",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"test_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"shape",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"0"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"+")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),"\ntest_X ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"append",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"x_zero_column_test",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," test_X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," axis",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"="),(0,m.kt)("span",N({parentName:"code"},{className:"token number"}),"1"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\ntest_X ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," np",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"asmatrix",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"test_X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("h3",null,"Generate Predictions"),(0,m.kt)("p",null,"Using the ",(0,m.kt)("inlineCode",{parentName:"p"},"test_X")," matrix, let's generate predictions and save them to a file:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"predictions ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," predict",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"test_X",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\nnp",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"savetxt",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"predictions.txt"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," predictions",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("h3",null,"Prepare Submission For Kaggle"),(0,m.kt)("p",null,"The ",(0,m.kt)("inlineCode",{parentName:"p"},"predictions.txt")," file isn't in the format that Kaggle needs for submission. Let's put our predictions into a pandas ",(0,m.kt)("inlineCode",{parentName:"p"},"DataFrame")," along with the ",(0,m.kt)("inlineCode",{parentName:"p"},"PassengerId")," column:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),(0,m.kt)("span",N({parentName:"code"},{className:"token comment"}),"# Function to flatten nested lists"),"\nflatten ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"lambda")," l",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),":")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),"item ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"for")," sublist ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"in")," l ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"for")," item ",(0,m.kt)("span",N({parentName:"code"},{className:"token keyword"}),"in")," sublist",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),"\n",(0,m.kt)("span",N({parentName:"code"},{className:"token comment"}),"# Temp DataFrame to get PassengerIds"),"\ntemp_df ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," pd",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"read_csv",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"../data/test.csv"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\nsubmission_df ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," pd",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"DataFrame",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\nsubmission_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"PassengerId"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," temp_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"PassengerId"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]"),"\nsubmission_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"["),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"Survived"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"]")," ",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"=")," pd",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"Series",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"flatten",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),"predictions",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"flatten",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"tolist",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("p",null,"Let's export to CSV for upload to Kaggle:"),(0,m.kt)("pre",N({},{className:"language-python"}),(0,m.kt)("code",N({parentName:"pre"},{className:"language-python"}),"submission_df",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"."),"to_csv",(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),"("),(0,m.kt)("span",N({parentName:"code"},{className:"token string"}),'"kaggle_submission.csv"'),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),",")," index",(0,m.kt)("span",N({parentName:"code"},{className:"token operator"}),"="),(0,m.kt)("span",N({parentName:"code"},{className:"token boolean"}),"False"),(0,m.kt)("span",N({parentName:"code"},{className:"token punctuation"}),")"),"\n")),(0,m.kt)("h2",null,"Results"),(0,m.kt)("p",null,"According to Kaggle's online judge, my model had an accuracy of 74.641% on the test dataset, which is not great by machine learning standards, but was nevertheless exciting for me, since I implemented the model (almost) from scratch."),(0,m.kt)("p",null,"This was an improvement over my submission from last year, which was a linear regression algorithm using ",(0,m.kt)("inlineCode",{parentName:"p"},"scikit-learn"),"."),(0,m.kt)("p",null,(0,m.kt)("img",N({parentName:"p"},{src:"/static/img/kaggle-score-logistic.png",alt:"Kaggle leaderboard screenshot"})),"\n",(0,m.kt)("em",{parentName:"p"},(0,m.kt)("strong",{parentName:"em"},"Figure 2:")," Pics or it didn't happen")),(0,m.kt)("h2",null,"Conclusion"),(0,m.kt)("p",null,"This project was also a chance to dip my toes into creating Machine Learning models for use on real data, taking the theory and applying it to a real-world problem."),(0,m.kt)("p",null,"Based on my results, I can also conclude that feature engineering (such as using polynomial features) may be needed to achieve a higher accuracy. Additionally, using something like neural networks may be a better option to achieve higher accuracy, due to their ability to learn complex nonlinear hypotheses."),(0,m.kt)("p",null,"If you are a machine learning expert and have suggestions on how I could improve the accuracy of my toy model, I would love to hear them! Comment on the Hacker News thread linked below or email me at the address below."),(0,m.kt)("p",null,(0,m.kt)("a",N({parentName:"p"},{href:"https://news.ycombinator.com/item?id=17692378"}),"Discuss on Hacker News")))}k.isMDXComponent=!0},888:function(a,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/predicting-titanic-survivors",function(){return t(9622)}])}},function(a){a.O(0,[774,888,179],(function(){return e=888,a(a.s=e);var e}));var e=a.O();_N_E=e}]);